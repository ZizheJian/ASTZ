command= python3 -u /u/zjian1/ASTZ/py_code/generate_stencil_list.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -c '/u/zjian1/ASTZ/stencil_list/1.0e-01/16_11_27_1536_0035.bin.txt' -E REL 1.0e-01 -4 16 11 27 1536 -M FHDE 9 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
stencil=8000, total_loss=0.00046997869840763036, total_rmsqb=0.05419748024629641
stencil=8001, total_loss=0.00048316695919215625, total_rmsqb=0.054952647751959835
stencil=8002, total_loss=0.0004458904843135284, total_rmsqb=0.05279029765931949
stencil=8003, total_loss=0.000492134038393208, total_rmsqb=0.055460235664460976
stencil=8004, total_loss=0.00045277832369533023, total_rmsqb=0.053196470964677854
stencil=8005, total_loss=0.0005885695307630403, total_rmsqb=0.060651129975203284
stencil=8006, total_loss=0.00046603223293739183, total_rmsqb=0.053969449282521856
stencil=8007, total_loss=0.000522310157392286, total_rmsqb=0.057135264799437015
stencil=8008, total_loss=0.00042910278700089056, total_rmsqb=0.05178699082545313
stencil=8009, total_loss=0.000448796370116709, total_rmsqb=0.05296203652834199
stencil=8010, total_loss=0.000425740771595179, total_rmsqb=0.05158371664071782
stencil=8011, total_loss=0.000402070410611895, total_rmsqb=0.05012923364988082
stencil=8012, total_loss=0.0003137160830780997, total_rmsqb=0.04428008038879472
stencil=8013, total_loss=0.0004131227088231765, total_rmsqb=0.05081355065476977
stencil=8014, total_loss=0.0003819437931156334, total_rmsqb=0.04885845583901223
[16, 11, 27, 1536]
stencil=4000, total_loss=0.0004938397020010809, total_rmsqb=0.058480274748273234
stencil=4071, total_loss=0.00038867186722809835, total_rmsqb=0.051880954400988694
stencil=4072, total_loss=0.00040776106122603843, total_rmsqb=0.05313972209084493
stencil=4093, total_loss=0.0005525290070778772, total_rmsqb=0.061857725187394824
stencil=4094, total_loss=0.0005301575139240649, total_rmsqb=0.06059249893717846
stencil=4099, total_loss=0.0005196827500061304, total_rmsqb=0.05999092440630321
stencil=4100, total_loss=0.00047368774088533294, total_rmsqb=0.05727465423039625
[16, 11, 14, 1536]
stencil=4000, total_loss=0.00047949808403795885, total_rmsqb=0.060657741529007436
stencil=4071, total_loss=0.0005290713892086492, total_rmsqb=0.06371621021319379
stencil=4072, total_loss=0.0004447764965728771, total_rmsqb=0.05842029059585026
stencil=4093, total_loss=0.0005289349995686697, total_rmsqb=0.06370799696325596
stencil=4094, total_loss=0.0005588491505404791, total_rmsqb=0.06548473820959293
stencil=4099, total_loss=0.0005716108406268779, total_rmsqb=0.06622821140312905
stencil=4100, total_loss=0.0005468529281049871, total_rmsqb=0.0647780796277274
[16, 11, 14, 1536]
stencil=2000, total_loss=0.0006828826558975537, total_rmsqb=0.07619776518635503
stencil=2091, total_loss=0.0005944885834372152, total_rmsqb=0.07109530999923984
stencil=2092, total_loss=0.0005979828266014887, total_rmsqb=0.0713039433809861
[16, 11, 14, 768]
stencil=2000, total_loss=0.0005171656452704718, total_rmsqb=0.06980080338677357
stencil=2091, total_loss=0.0004676892492908837, total_rmsqb=0.06637801806873132
stencil=2092, total_loss=0.0004669731234384928, total_rmsqb=0.06632717958442617
[16, 11, 14, 768]
stencil=1000, total_loss=0.0008032301263165619, total_rmsqb=0.09156763063322604
[8, 6, 7, 384]
stencil=8000, total_loss=0.0005785542857819069, total_rmsqb=0.08180322667588827
stencil=8001, total_loss=0.0006531009981260339, total_rmsqb=0.08691376244564243
stencil=8002, total_loss=0.0006175656697478311, total_rmsqb=0.08451619759499406
stencil=8003, total_loss=0.0006115794819050497, total_rmsqb=0.08410558390846196
stencil=8004, total_loss=0.0005636360191247692, total_rmsqb=0.08074167345693528
stencil=8005, total_loss=0.0006130575164996005, total_rmsqb=0.08420715365514608
stencil=8006, total_loss=0.000618962032098644, total_rmsqb=0.08461169237969289
stencil=8007, total_loss=0.0005682444878397124, total_rmsqb=0.08107108637962072
stencil=8008, total_loss=0.0003452214953103477, total_rmsqb=0.06318984522412473
stencil=8009, total_loss=0.0005890898403743041, total_rmsqb=0.08254469047359257
stencil=8010, total_loss=0.0003686205764486327, total_rmsqb=0.06529623852659656
stencil=8011, total_loss=0.0003655786311301459, total_rmsqb=0.06502626028880595
stencil=8012, total_loss=0.00035867861691577343, total_rmsqb=0.06440967683388625
stencil=8013, total_loss=0.00038427327268272544, total_rmsqb=0.06666815960794846
stencil=8014, total_loss=0.0004186011376245271, total_rmsqb=0.06958226781087148
[8, 6, 7, 384]
stencil=4002, total_loss=0.0005268955420683479, total_rmsqb=0.08217449308757745
stencil=4015, total_loss=0.0004938498086306774, total_rmsqb=0.07955586764363314
stencil=4016, total_loss=0.0007972891910137537, total_rmsqb=0.10108406767057473
stencil=4077, total_loss=0.0005955696795314969, total_rmsqb=0.08736572022564304
stencil=4078, total_loss=0.0005697882910025376, total_rmsqb=0.08545382989468583
stencil=4081, total_loss=0.0005845516228893496, total_rmsqb=0.08655381342005802
stencil=4082, total_loss=0.00045893206464458976, total_rmsqb=0.07669180735215622
[8, 6, 7, 384]
stencil=2009, total_loss=0.0007484395510999817, total_rmsqb=0.10309308389468863
stencil=2031, total_loss=0.0007210323907073899, total_rmsqb=0.10118789321779019
stencil=2032, total_loss=0.0010386515639634988, total_rmsqb=0.12144680838439427
[8, 3, 7, 384]
stencil=2006, total_loss=0.000998813248469452, total_rmsqb=0.12536309576162
stencil=2055, total_loss=0.00045383334143724274, total_rmsqb=0.0845037068977412
stencil=2059, total_loss=0.0007510663178216791, total_rmsqb=0.10870930122407735
[8, 2, 7, 384]
stencil=2006, total_loss=0.0009621332937139805, total_rmsqb=0.12951544957490602
stencil=2055, total_loss=0.0005545909160379896, total_rmsqb=0.0983309718817432
stencil=2059, total_loss=0.0006683039227648387, total_rmsqb=0.1079421243548234
[8, 1, 7, 384]
stencil=1004, total_loss=0.0009780615263416314, total_rmsqb=0.1374559166266954
[4, 1, 4, 192]
stencil=4013, total_loss=0.000566414835644357, total_rmsqb=0.11010931356042995
stencil=4073, total_loss=0.0008422776033388979, total_rmsqb=0.1342716641501378
stencil=4074, total_loss=0.0013285321874630133, total_rmsqb=0.16863308519982123
stencil=4095, total_loss=0.0014709637718804088, total_rmsqb=0.17744253509612756
stencil=4096, total_loss=0.0014178278899033285, total_rmsqb=0.1742081636121064
stencil=4101, total_loss=0.0015568215889434744, total_rmsqb=0.18254761697995406
stencil=4102, total_loss=0.0012071258980307362, total_rmsqb=0.160743355137646
[2, 1, 4, 192]
stencil=4013, total_loss=0.0009573999641489395, total_rmsqb=0.1506884075524064
stencil=4073, total_loss=0.0006164545696141294, total_rmsqb=0.12091597385901069
stencil=4074, total_loss=0.0005545701510506814, total_rmsqb=0.11468625865099696
stencil=4095, total_loss=0.0015999781090258991, total_rmsqb=0.19480054170869862
stencil=4096, total_loss=0.000592570226707551, total_rmsqb=0.1185504081017341
stencil=4101, total_loss=0.0011298654634998814, total_rmsqb=0.1636991810796289
stencil=4102, total_loss=0.0008841328705764479, total_rmsqb=0.14480778432029384
[2, 1, 4, 192]
stencil=2014, total_loss=0.0006737037963135456, total_rmsqb=0.13305893159528237
stencil=2095, total_loss=0.0009133631411271218, total_rmsqb=0.154928485491926
stencil=2096, total_loss=0.0008751935600183713, total_rmsqb=0.15165669638052837
[1, 1, 2, 192]
stencil=2090, total_loss=0.0007222413787267346, total_rmsqb=0.14501973679434385
stencil=2103, total_loss=0.0010835882411270902, total_rmsqb=0.177630717931309
stencil=2104, total_loss=0.0012114809174090624, total_rmsqb=0.18782103015273993
[1, 1, 1, 192]
stencil=1014, total_loss=0.0012617842100250225, total_rmsqb=0.2017691982186528
[1, 1, 1, 96]
stencil=1014, total_loss=0.0012356042603237762, total_rmsqb=0.2101737229701275
[1, 1, 1, 48]
stencil=1014, total_loss=0.0017399501469400195, total_rmsqb=0.2625327670653793
[1, 1, 1, 24]
stencil=1014, total_loss=0.0006305786933248433, total_rmsqb=0.16636468969840693
[1, 1, 1, 12]
stencil=1014, total_loss=0.0004003155045211315, total_rmsqb=0.13953048646829977
[1, 1, 1, 6]
stencil=1014, total_loss=0.0010628431104123593, total_rmsqb=0.23931993623288636
[1, 1, 1, 3]
stencil=1014, total_loss=6.482955541287083e-06, total_rmsqb=0.0196746590020068
[1, 1, 1, 2]
stencil=1014, total_loss=0.00036147862556390464, total_rmsqb=0.15464589565068868
[1, 1, 1, 1]
python3 -u /u/zjian1/ASTZ/py_code/compress.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -z '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_1.0e-01.astz' -c '/u/zjian1/ASTZ/stencil_list/1.0e-01/16_11_27_1536_0035.bin.txt' -E REL 1.0e-01 -4 16 11 27 1536 -M FHDE_gpu 9 -a 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
torch.Size([1, 1, 1, 1, 1, 96])
torch.Size([1, 1, 1, 1, 1, 192])
torch.Size([1, 1, 1, 1, 2, 192])
torch.Size([1, 1, 2, 1, 4, 192])
torch.Size([1, 1, 2, 1, 4, 192])
torch.Size([1, 1, 4, 1, 4, 192])
torch.Size([1, 1, 8, 1, 7, 384])
torch.Size([1, 1, 8, 2, 7, 384])
torch.Size([1, 1, 8, 3, 7, 384])
torch.Size([1, 1, 8, 6, 7, 384])
torch.Size([1, 1, 8, 6, 7, 384])
torch.Size([1, 1, 8, 6, 7, 384])
torch.Size([1, 1, 16, 11, 14, 768])
torch.Size([1, 1, 16, 11, 14, 768])
torch.Size([1, 1, 16, 11, 14, 1536])
torch.Size([1, 1, 16, 11, 14, 1536])
torch.Size([1, 1, 16, 11, 27, 1536])
torch.Size([1, 1, 16, 11, 27, 1536])
Huffman CR= 31.841
Zstd CR= 115.994
[31mTotal CR= 3693.395 [0m
qb_min= -1, qb_max= 4
max_err= 12.149925231933594
max_rel_err= 0.100
[31mpsnr= 38.349 [0m
====================================== BEGIN TUNING ================================
Tuning time = 1.9386e-05s
====================================== END TUNING ======================================
prediction time = 0.113958s
compression ratio = 1237.81 
compression time = 0.154072
compressed data file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_1.0e-01.qoz2
Min=-30.5, Max=91, range=121.5
Max absolute error = 12
Max relative error = 0.1
Max pw relative error = 1.1E+07
PSNR = 33.010406, NRMSE= 0.02236040575
normError = 7339.893893, normErr_norm = 1.034317
acEff=0.128262
compression ratio = 1237.812693
decompression time = 0.063489 seconds.
decompressed file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_1.0e-01.qoz2.bin
type=float nx=27 ny=11 nz=16 nw=1 raw=19008 zfp=3352 ratio=5.67 rate=5.643 rmse=0.355 nrmse=0.004012 maxe=1.693 psnr=41.91
cuSZp finished!
cuSZp compression   end-to-end speed: 66.148486 GB/s
cuSZp decompression end-to-end speed: 87.405040 GB/s
cuSZp compression ratio: 115.935576

[0;32mPass error check![0m
command= python3 -u /u/zjian1/ASTZ/py_code/generate_stencil_list.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -c '/u/zjian1/ASTZ/stencil_list/6.0e-02/16_11_27_1536_0035.bin.txt' -E REL 6.0e-02 -4 16 11 27 1536 -M FHDE 9 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
stencil=8000, total_loss=0.00032489138546650643, total_rmsqb=0.07510309875182813
stencil=8001, total_loss=0.00035716482597831746, total_rmsqb=0.07874502034281428
stencil=8002, total_loss=0.00041200028010010293, total_rmsqb=0.08457412512480865
stencil=8003, total_loss=0.0003405766502631055, total_rmsqb=0.07689466214938333
stencil=8004, total_loss=0.0004653499181466534, total_rmsqb=0.08988321108244027
stencil=8005, total_loss=0.00041093801139907517, total_rmsqb=0.08446502516236166
stencil=8006, total_loss=0.00037035829206910555, total_rmsqb=0.08018622986232164
stencil=8007, total_loss=0.0003952918496980885, total_rmsqb=0.08284144931086822
stencil=8008, total_loss=0.00040810148889635663, total_rmsqb=0.08417300810437706
stencil=8009, total_loss=0.0003250566483640455, total_rmsqb=0.07512219771581212
stencil=8010, total_loss=0.0003361915403420734, total_rmsqb=0.07639802802752392
stencil=8011, total_loss=0.0002617219337634434, total_rmsqb=0.06740759283850747
stencil=8012, total_loss=0.000372261486145552, total_rmsqb=0.08039199601552557
stencil=8013, total_loss=0.00025851756247531496, total_rmsqb=0.06699367228557898
stencil=8014, total_loss=0.0002647972962943853, total_rmsqb=0.06780247254258973
[16, 6, 27, 1536]
stencil=8000, total_loss=0.00034145154027832354, total_rmsqb=0.08104564651946738
stencil=8001, total_loss=0.00034997368371815534, total_rmsqb=0.0820508052124193
stencil=8002, total_loss=0.0003974231964824103, total_rmsqb=0.08743629749052824
stencil=8003, total_loss=0.0003371945750190269, total_rmsqb=0.08053885339596711
stencil=8004, total_loss=0.0004682729284106435, total_rmsqb=0.09491059119951879
stencil=8005, total_loss=0.0005087171968458388, total_rmsqb=0.09892438578875609
stencil=8006, total_loss=0.0004237290719020057, total_rmsqb=0.09028368646901967
stencil=8007, total_loss=0.00044552446649931545, total_rmsqb=0.09257653726920724
stencil=8008, total_loss=0.0004300504950863029, total_rmsqb=0.09095464413259581
stencil=8009, total_loss=0.0003505901377195183, total_rmsqb=0.08212303677670162
stencil=8010, total_loss=0.0003271998085436025, total_rmsqb=0.07933625085608734
stencil=8011, total_loss=0.0002529785909916758, total_rmsqb=0.0697600908769232
stencil=8012, total_loss=0.000411061087319828, total_rmsqb=0.08892386615952741
stencil=8013, total_loss=0.0002549969149401868, total_rmsqb=0.07003781940969046
stencil=8014, total_loss=0.000279375927575142, total_rmsqb=0.07330939648253518
[16, 6, 14, 1536]
stencil=8000, total_loss=0.0004900535233785981, total_rmsqb=0.10220292039729888
stencil=8001, total_loss=0.0004758068104542612, total_rmsqb=0.10070635441272728
stencil=8002, total_loss=0.0004979917182103932, total_rmsqb=0.1030273686321184
stencil=8003, total_loss=0.00046601407930782235, total_rmsqb=0.09966463180115405
stencil=8004, total_loss=0.0004866448033147282, total_rmsqb=0.10184684798551424
stencil=8005, total_loss=0.000526544043545996, total_rmsqb=0.10593973928895636
stencil=8006, total_loss=0.00048648501155737055, total_rmsqb=0.10183012570382012
stencil=8007, total_loss=0.0004856302685828897, total_rmsqb=0.10174062978175934
stencil=8008, total_loss=0.00044954877902046036, total_rmsqb=0.09788811351670394
stencil=8009, total_loss=0.0005115334704895428, total_rmsqb=0.10441877056974495
stencil=8010, total_loss=0.0003884893629743911, total_rmsqb=0.09099784630566181
stencil=8011, total_loss=0.0004319290083706052, total_rmsqb=0.09595060862178396
stencil=8012, total_loss=0.00043670106423601647, total_rmsqb=0.09647919537737573
stencil=8013, total_loss=0.00028749546208382983, total_rmsqb=0.07828112253664694
stencil=8014, total_loss=0.0002963937166671414, total_rmsqb=0.07948332820851332
[16, 3, 14, 1536]
stencil=8000, total_loss=0.0006941492858406136, total_rmsqb=0.1280396219020755
stencil=8001, total_loss=0.0006510564405660178, total_rmsqb=0.12400159236267874
stencil=8002, total_loss=0.0006780874985208253, total_rmsqb=0.12654961004326246
stencil=8003, total_loss=0.0006242059689252788, total_rmsqb=0.12141767182493199
stencil=8004, total_loss=0.0006380705133492636, total_rmsqb=0.12275869984536178
stencil=8005, total_loss=0.0006998987978068927, total_rmsqb=0.12856879282614297
stencil=8006, total_loss=0.0006393013424601801, total_rmsqb=0.12287704271138851
stencil=8007, total_loss=0.0006708631345787267, total_rmsqb=0.1258736732456447
stencil=8008, total_loss=0.0005945404434246884, total_rmsqb=0.11849735152983007
stencil=8009, total_loss=0.0006245331299707123, total_rmsqb=0.12144948658707135
stencil=8010, total_loss=0.0005823333276402873, total_rmsqb=0.11727454737016714
stencil=8011, total_loss=0.0005879639389825108, total_rmsqb=0.11784015030818468
stencil=8012, total_loss=0.0006472611415316099, total_rmsqb=0.12363963372978228
stencil=8013, total_loss=0.0004493283500531297, total_rmsqb=0.10301485436641623
stencil=8014, total_loss=0.0003088765151748436, total_rmsqb=0.08541032743904124
[8, 3, 14, 1536]
stencil=8000, total_loss=0.0006436060656169661, total_rmsqb=0.12977899340310545
stencil=8001, total_loss=0.0006530993691034584, total_rmsqb=0.13073262130255184
stencil=8002, total_loss=0.0006641291198766392, total_rmsqb=0.13183192651563602
stencil=8003, total_loss=0.0006321655277032532, total_rmsqb=0.12862036629383816
stencil=8004, total_loss=0.0006818807991795501, total_rmsqb=0.13358219267301688
stencil=8005, total_loss=0.0006706607255940678, total_rmsqb=0.132478613548475
stencil=8006, total_loss=0.0006386138878172458, total_rmsqb=0.12927469343420106
stencil=8007, total_loss=0.0006563021730046612, total_rmsqb=0.13105278610733748
stencil=8008, total_loss=0.000705649568108669, total_rmsqb=0.13589043133784376
stencil=8009, total_loss=0.0005907302409476777, total_rmsqb=0.1243337232765757
stencil=8010, total_loss=0.0006206084048312639, total_rmsqb=0.1274392372849022
stencil=8011, total_loss=0.0005709097114199831, total_rmsqb=0.12223006773669287
stencil=8012, total_loss=0.0006194251086184963, total_rmsqb=0.12731768695219706
stencil=8013, total_loss=0.00041109437117073876, total_rmsqb=0.10372061955942145
stencil=8014, total_loss=0.0003622031377267896, total_rmsqb=0.0973577304383503
[4, 3, 14, 1536]
stencil=8000, total_loss=0.0007025702563426736, total_rmsqb=0.1427301136922328
stencil=8001, total_loss=0.0006188824920037571, total_rmsqb=0.133959904805069
stencil=8002, total_loss=0.0006653157217476201, total_rmsqb=0.1388943644669106
stencil=8003, total_loss=0.0006580978072808302, total_rmsqb=0.13813888738327695
stencil=8004, total_loss=0.0006873182376365698, total_rmsqb=0.14117235701727482
stencil=8005, total_loss=0.0006642372739359731, total_rmsqb=0.1387817479536857
stencil=8006, total_loss=0.0006803072483570217, total_rmsqb=0.14045049719370648
stencil=8007, total_loss=0.0006413975368327445, total_rmsqb=0.13637487820373445
stencil=8008, total_loss=0.0006955755876805656, total_rmsqb=0.14201783820014455
stencil=8009, total_loss=0.0006116313853395869, total_rmsqb=0.13317282520760948
stencil=8010, total_loss=0.0006747350691427413, total_rmsqb=0.13987412197666596
stencil=8011, total_loss=0.000585995805480805, total_rmsqb=0.13035208601201576
stencil=8012, total_loss=0.0006361882431246492, total_rmsqb=0.13581994533836916
stencil=8013, total_loss=0.0004364787810645384, total_rmsqb=0.11249994231164219
stencil=8014, total_loss=0.0003993029715601321, total_rmsqb=0.10760241110982365
[2, 3, 14, 1536]
stencil=8000, total_loss=0.00043288969668194905, total_rmsqb=0.11793310992605988
stencil=8001, total_loss=0.0006244894902492007, total_rmsqb=0.14164775428009904
stencil=8002, total_loss=0.0004171543300566352, total_rmsqb=0.11576985904344533
stencil=8003, total_loss=0.0006444942629815971, total_rmsqb=0.1438986284223421
stencil=8004, total_loss=0.0004026218216998976, total_rmsqb=0.11373543194344513
stencil=8005, total_loss=0.0006400300427053407, total_rmsqb=0.14339939087960385
stencil=8006, total_loss=0.000406214215200553, total_rmsqb=0.11424170737824496
stencil=8007, total_loss=0.0006809430248463468, total_rmsqb=0.14791169515137811
stencil=8008, total_loss=0.0004113268908504133, total_rmsqb=0.11495839135446079
stencil=8009, total_loss=0.0006571225730799835, total_rmsqb=0.14530157423752696
stencil=8010, total_loss=0.0003902841574998825, total_rmsqb=0.11197925863217317
stencil=8011, total_loss=0.000604270890658693, total_rmsqb=0.13933587953928675
stencil=8012, total_loss=0.0004068356970570365, total_rmsqb=0.1143290652431895
stencil=8013, total_loss=0.000422455433537781, total_rmsqb=0.11650312552734861
stencil=8014, total_loss=0.00037848202202598957, total_rmsqb=0.11027314330158883
[1, 3, 14, 1536]
stencil=4038, total_loss=0.0004273097641956905, total_rmsqb=0.1233374399126151
stencil=4075, total_loss=0.0006169151816611243, total_rmsqb=0.14819592103586576
stencil=4076, total_loss=0.0005838368479432403, total_rmsqb=0.14416813221011973
stencil=4097, total_loss=0.0006467423929168857, total_rmsqb=0.15173619379158135
stencil=4098, total_loss=0.0006319511353562827, total_rmsqb=0.14999102413333662
stencil=4103, total_loss=0.0006480989840493542, total_rmsqb=0.15189524950445596
stencil=4104, total_loss=0.0006493528938953346, total_rmsqb=0.15204211820664162
[1, 2, 14, 1536]
stencil=4038, total_loss=0.0002531182945841684, total_rmsqb=0.09992213015846771
stencil=4075, total_loss=0.0005381141959260854, total_rmsqb=0.1456924815496346
stencil=4076, total_loss=0.0006889389649310678, total_rmsqb=0.1648505081121427
stencil=4097, total_loss=0.0006738582278456034, total_rmsqb=0.16303625231403415
stencil=4098, total_loss=0.0006283245190945406, total_rmsqb=0.15743160379302806
stencil=4103, total_loss=0.0006762919198050136, total_rmsqb=0.16333039609300842
stencil=4104, total_loss=0.0006347432735884655, total_rmsqb=0.15823369499860349
[1, 1, 14, 1536]
stencil=2090, total_loss=0.0008977837873627993, total_rmsqb=0.19808983484334777
stencil=2103, total_loss=0.0010064421026721934, total_rmsqb=0.20973490269235592
stencil=2104, total_loss=0.0009480208862757633, total_rmsqb=0.2035566352587404
[1, 1, 7, 1536]
stencil=2090, total_loss=0.000576667626790533, total_rmsqb=0.16711502226385844
stencil=2103, total_loss=0.0008839992783213325, total_rmsqb=0.20690865644125117
stencil=2104, total_loss=0.0007813069841039737, total_rmsqb=0.19451968546179005
[1, 1, 4, 1536]
stencil=2090, total_loss=0.000509697862708758, total_rmsqb=0.16538095915070253
stencil=2103, total_loss=0.0008984475737204216, total_rmsqb=0.21957124794014132
stencil=2104, total_loss=0.0008176468873663961, total_rmsqb=0.20946525463007218
[1, 1, 2, 1536]
stencil=2090, total_loss=0.0006897285242355766, total_rmsqb=0.20250912085842793
stencil=2103, total_loss=0.0009699961473117951, total_rmsqb=0.24015437317202235
stencil=2104, total_loss=0.0006646080212279533, total_rmsqb=0.19878713937214318
[1, 1, 2, 1536]
stencil=1012, total_loss=0.0005344326500384269, total_rmsqb=0.18764127740314612
[1, 1, 1, 768]
stencil=1014, total_loss=0.0008344151826653009, total_rmsqb=0.2468024025477301
[1, 1, 1, 384]
stencil=1014, total_loss=0.0009409194191296895, total_rmsqb=0.27587407808808184
[1, 1, 1, 192]
stencil=1014, total_loss=0.0007360814682518443, total_rmsqb=0.25684671504025036
[1, 1, 1, 96]
stencil=1014, total_loss=0.0007772485001219644, total_rmsqb=0.2778224997983026
[1, 1, 1, 48]
stencil=1014, total_loss=0.0007701413705945015, total_rmsqb=0.29110461453911507
[1, 1, 1, 24]
stencil=1014, total_loss=0.0008686636059652441, total_rmsqb=0.3254363579968928
[1, 1, 1, 12]
stencil=1014, total_loss=0.00012993941513391642, total_rmsqb=0.13249122218728132
[1, 1, 1, 6]
stencil=1014, total_loss=3.833805385511368e-06, total_rmsqb=0.02395565659223017
[1, 1, 1, 3]
stencil=1014, total_loss=6.482955541287083e-06, total_rmsqb=0.032791098336678
[1, 1, 1, 2]
stencil=1014, total_loss=1.3980793482915033e-05, total_rmsqb=0.05068876930656579
[1, 1, 1, 1]
python3 -u /u/zjian1/ASTZ/py_code/compress.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -z '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_6.0e-02.astz' -c '/u/zjian1/ASTZ/stencil_list/6.0e-02/16_11_27_1536_0035.bin.txt' -E REL 6.0e-02 -4 16 11 27 1536 -M FHDE_gpu 9 -a 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
torch.Size([1, 1, 1, 1, 1, 96])
torch.Size([1, 1, 1, 1, 1, 192])
torch.Size([1, 1, 1, 1, 1, 384])
torch.Size([1, 1, 1, 1, 1, 768])
torch.Size([1, 1, 1, 1, 2, 1536])
torch.Size([1, 1, 1, 1, 2, 1536])
torch.Size([1, 1, 1, 1, 4, 1536])
torch.Size([1, 1, 1, 1, 7, 1536])
torch.Size([1, 1, 1, 1, 14, 1536])
torch.Size([1, 1, 1, 2, 14, 1536])
torch.Size([1, 1, 1, 3, 14, 1536])
torch.Size([1, 1, 2, 3, 14, 1536])
torch.Size([1, 1, 4, 3, 14, 1536])
torch.Size([1, 1, 8, 3, 14, 1536])
torch.Size([1, 1, 16, 3, 14, 1536])
torch.Size([1, 1, 16, 6, 14, 1536])
torch.Size([1, 1, 16, 6, 27, 1536])
torch.Size([1, 1, 16, 11, 27, 1536])
Huffman CR= 31.623
Zstd CR= 40.427
[31mTotal CR= 1278.408 [0m
qb_min= -3, qb_max= 4
max_err= 7.289434432983398
max_rel_err= 0.060
[31mpsnr= 40.871 [0m
====================================== BEGIN TUNING ================================
Tuning time = 1.7242e-05s
====================================== END TUNING ======================================
prediction time = 0.117286s
compression ratio = 438.98 
compression time = 0.149723
compressed data file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_6.0e-02.qoz2
Min=-30.5, Max=91, range=121.5
Max absolute error = 7.3
Max relative error = 0.06
Max pw relative error = 2.7E+07
PSNR = 35.934066, NRMSE= 0.01596969862
normError = 5242.118355, normErr_norm = 1.029484
acEff=0.242932
compression ratio = 438.975913
decompression time = 0.063609 seconds.
decompressed file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_6.0e-02.qoz2.bin
type=float nx=27 ny=11 nz=16 nw=1 raw=19008 zfp=4024 ratio=4.72 rate=6.774 rmse=0.1744 nrmse=0.001971 maxe=0.9023 psnr=48.09
cuSZp finished!
cuSZp compression   end-to-end speed: 64.982613 GB/s
cuSZp decompression end-to-end speed: 84.510215 GB/s
cuSZp compression ratio: 95.280683

[0;32mPass error check![0m
command= python3 -u /u/zjian1/ASTZ/py_code/generate_stencil_list.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -c '/u/zjian1/ASTZ/stencil_list/3.0e-02/16_11_27_1536_0035.bin.txt' -E REL 3.0e-02 -4 16 11 27 1536 -M FHDE 9 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
stencil=8000, total_loss=0.00026777254367114835, total_rmsqb=0.1363646417980799
stencil=8001, total_loss=0.00025842250542427824, total_rmsqb=0.13396270869585472
stencil=8002, total_loss=0.000261463234907979, total_rmsqb=0.13474854021781413
stencil=8003, total_loss=0.0002561158324935357, total_rmsqb=0.13336349463380143
stencil=8004, total_loss=0.00031380074466606713, total_rmsqb=0.1476201828327956
stencil=8005, total_loss=0.0003121089924410677, total_rmsqb=0.14722172253504323
stencil=8006, total_loss=0.00031129901987796664, total_rmsqb=0.1470305665211335
stencil=8007, total_loss=0.0003006628859200422, total_rmsqb=0.14449694487351872
stencil=8008, total_loss=0.00027016402725990547, total_rmsqb=0.1369722263159137
stencil=8009, total_loss=0.0002423051568204603, total_rmsqb=0.12971795173151962
stencil=8010, total_loss=0.0002625975098726016, total_rmsqb=0.135040505721792
stencil=8011, total_loss=0.00020350901113899448, total_rmsqb=0.118880487120409
stencil=8012, total_loss=0.00030702474658206996, total_rmsqb=0.14601768028936835
stencil=8013, total_loss=0.0002090704567240738, total_rmsqb=0.12049390738518513
stencil=8014, total_loss=0.00021762485909592206, total_rmsqb=0.12293428096839715
[16, 11, 14, 1536]
stencil=8000, total_loss=0.0003353048119732218, total_rmsqb=0.1606257030967439
stencil=8001, total_loss=0.0003418842355213504, total_rmsqb=0.16219396342946027
stencil=8002, total_loss=0.0003458294043275863, total_rmsqb=0.16312709677435672
stencil=8003, total_loss=0.0003370476828111309, total_rmsqb=0.16104261779706702
stencil=8004, total_loss=0.0003372221450693644, total_rmsqb=0.16108429175806568
stencil=8005, total_loss=0.0003391196548121689, total_rmsqb=0.16153685729393782
stencil=8006, total_loss=0.00034339149525922997, total_rmsqb=0.16255110124352895
stencil=8007, total_loss=0.0003317477614237479, total_rmsqb=0.15977143989408296
stencil=8008, total_loss=0.0003409621114256146, total_rmsqb=0.16197508239870792
stencil=8009, total_loss=0.0003403663536519897, total_rmsqb=0.16183351226462464
stencil=8010, total_loss=0.00033039139950850216, total_rmsqb=0.15944448990405727
stencil=8011, total_loss=0.0003580223678015044, total_rmsqb=0.16597788602380373
stencil=8012, total_loss=0.00033280466343102807, total_rmsqb=0.160025742252196
stencil=8013, total_loss=0.00021465183465795812, total_rmsqb=0.12851755393559056
stencil=8014, total_loss=0.00022169944039462382, total_rmsqb=0.1306103060495991
[16, 6, 14, 1536]
stencil=8000, total_loss=0.00039016940415566526, total_rmsqb=0.18238879269536848
stencil=8001, total_loss=0.000391246088915668, total_rmsqb=0.182640273131934
stencil=8002, total_loss=0.00038776661643147054, total_rmsqb=0.18182632118831665
stencil=8003, total_loss=0.00038937224975807563, total_rmsqb=0.1822023783262182
stencil=8004, total_loss=0.00038681899763615466, total_rmsqb=0.18160401293858058
stencil=8005, total_loss=0.0003841844255735828, total_rmsqb=0.18098451607998847
stencil=8006, total_loss=0.0003847161226809967, total_rmsqb=0.18110971073387475
stencil=8007, total_loss=0.0003731540421353486, total_rmsqb=0.17836745617623154
stencil=8008, total_loss=0.0003782263114846343, total_rmsqb=0.17957563552833042
stencil=8009, total_loss=0.0003899562463651798, total_rmsqb=0.18233896446305506
stencil=8010, total_loss=0.0003747048759289477, total_rmsqb=0.17873772077981817
stencil=8011, total_loss=0.0003910404912046029, total_rmsqb=0.1825922785863003
stencil=8012, total_loss=0.00039715662744054447, total_rmsqb=0.18401467138072053
stencil=8013, total_loss=0.00023532277284942453, total_rmsqb=0.1416457414019573
stencil=8014, total_loss=0.0002286101888591922, total_rmsqb=0.13961090251206704
[8, 6, 14, 1536]
stencil=8000, total_loss=0.00038705590341220797, total_rmsqb=0.19122064816708592
stencil=8001, total_loss=0.00038736904296325593, total_rmsqb=0.19129798407821935
stencil=8002, total_loss=0.0003958171993356069, total_rmsqb=0.19337274794618792
stencil=8003, total_loss=0.00038682298659319006, total_rmsqb=0.19116310453171229
stencil=8004, total_loss=0.00039114891151734854, total_rmsqb=0.1922290417884735
stencil=8005, total_loss=0.00038015483430996227, total_rmsqb=0.18950828304813944
stencil=8006, total_loss=0.00039164518991668273, total_rmsqb=0.1923509504498907
stencil=8007, total_loss=0.00037274592522752714, total_rmsqb=0.18765251541807443
stencil=8008, total_loss=0.00039011130774628126, total_rmsqb=0.19197390873786765
stencil=8009, total_loss=0.00038373556646658546, total_rmsqb=0.19039869389775657
stencil=8010, total_loss=0.00038556386530171603, total_rmsqb=0.19085172990766053
stencil=8011, total_loss=0.0003803449394620524, total_rmsqb=0.18955566110949262
stencil=8012, total_loss=0.0003830160742642057, total_rmsqb=0.19022011434842898
stencil=8013, total_loss=0.0002398358680653154, total_rmsqb=0.15052374149212133
stencil=8014, total_loss=0.0002552973605257143, total_rmsqb=0.15529987295640865
[8, 3, 14, 1536]
stencil=8000, total_loss=0.0005144356259242718, total_rmsqb=0.23205442336666843
stencil=8001, total_loss=0.0005266130360499291, total_rmsqb=0.2347848856445216
stencil=8002, total_loss=0.0005040327691362685, total_rmsqb=0.2296961516609228
stencil=8003, total_loss=0.0005114863724442768, total_rmsqb=0.23138828459331248
stencil=8004, total_loss=0.0005132387042634077, total_rmsqb=0.23178430918841664
stencil=8005, total_loss=0.0005053741356733385, total_rmsqb=0.23000159015025534
stencil=8006, total_loss=0.0005243720662775951, total_rmsqb=0.23428479664630525
stencil=8007, total_loss=0.000490885258450958, total_rmsqb=0.22668058663424703
stencil=8008, total_loss=0.0005365467852246868, total_rmsqb=0.2369889688569146
stencil=8009, total_loss=0.0004742732875488521, total_rmsqb=0.22281204522278464
stencil=8010, total_loss=0.0005281264766259807, total_rmsqb=0.235122019379699
stencil=8011, total_loss=0.00047155492453428643, total_rmsqb=0.22217258857881997
stencil=8012, total_loss=0.00051679039416053, total_rmsqb=0.23258491783000643
stencil=8013, total_loss=0.00031740096151654815, total_rmsqb=0.182275564466086
stencil=8014, total_loss=0.000308046549543434, total_rmsqb=0.17956947258825065
[4, 3, 14, 1536]
stencil=8000, total_loss=0.0005278644143806617, total_rmsqb=0.2474354495344011
stencil=8001, total_loss=0.0005216918284659641, total_rmsqb=0.24598450138555011
stencil=8002, total_loss=0.0005205602445419999, total_rmsqb=0.24571757827400187
stencil=8003, total_loss=0.0005271546038412941, total_rmsqb=0.24726903239460674
stencil=8004, total_loss=0.0005241476975951958, total_rmsqb=0.24656280875060987
stencil=8005, total_loss=0.0005172707809426623, total_rmsqb=0.24493999298584704
stencil=8006, total_loss=0.0005190232030497893, total_rmsqb=0.24535454890421468
stencil=8007, total_loss=0.0004998215639017635, total_rmsqb=0.24077324282005025
stencil=8008, total_loss=0.0005317977435346697, total_rmsqb=0.24835560891119166
stencil=8009, total_loss=0.0005061822882295573, total_rmsqb=0.24230043837689938
stencil=8010, total_loss=0.0005453968851397009, total_rmsqb=0.25151104064503155
stencil=8011, total_loss=0.0004836130838409093, total_rmsqb=0.2368371075395223
stencil=8012, total_loss=0.0005058830005563276, total_rmsqb=0.24222879594832775
stencil=8013, total_loss=0.00033961026292206764, total_rmsqb=0.19846829122694784
stencil=8014, total_loss=0.00030047163583962945, total_rmsqb=0.18668200997085463
[2, 3, 14, 1536]
stencil=8000, total_loss=0.00029672140591763713, total_rmsqb=0.19527720988349687
stencil=8001, total_loss=0.0004878201924269431, total_rmsqb=0.2503842511382092
stencil=8002, total_loss=0.000289422600308262, total_rmsqb=0.19286052416575614
stencil=8003, total_loss=0.0004928236160025365, total_rmsqb=0.25166503298322745
stencil=8004, total_loss=0.0002882243706783386, total_rmsqb=0.1924608821301206
stencil=8005, total_loss=0.0004693836570077858, total_rmsqb=0.24560720583101006
stencil=8006, total_loss=0.0002869178943985155, total_rmsqb=0.1920241890682752
stencil=8007, total_loss=0.00046786466190122433, total_rmsqb=0.24520947312342098
stencil=8008, total_loss=0.0002929964261888556, total_rmsqb=0.19404760359975343
stencil=8009, total_loss=0.0004879052746834242, total_rmsqb=0.25040608533920566
stencil=8010, total_loss=0.0002935617037091953, total_rmsqb=0.1942347012617401
stencil=8011, total_loss=0.0004760376292893257, total_rmsqb=0.2473419407187138
stencil=8012, total_loss=0.00028732920262827246, total_rmsqb=0.19216177693825365
stencil=8013, total_loss=0.0003272220297902106, total_rmsqb=0.2050682330411594
stencil=8014, total_loss=0.0002960479084562403, total_rmsqb=0.19505546413559838
[2, 3, 14, 1536]
stencil=4003, total_loss=0.0004610153754331401, total_rmsqb=0.2562189351210608
stencil=4030, total_loss=0.00030791069484885944, total_rmsqb=0.20939480548837022
stencil=4032, total_loss=0.0004433008203966897, total_rmsqb=0.2512480989851973
stencil=4059, total_loss=0.00046572366558247295, total_rmsqb=0.2575239768822801
stencil=4061, total_loss=0.00047468985209004656, total_rmsqb=0.2599911055002796
stencil=4067, total_loss=0.0004725290648088024, total_rmsqb=0.2593986910613082
stencil=4069, total_loss=0.0004673178046014878, total_rmsqb=0.2579643435065628
[2, 2, 14, 1536]
stencil=4003, total_loss=0.0005144701950607226, total_rmsqb=0.28491152775419915
stencil=4030, total_loss=0.00019004019298140512, total_rmsqb=0.1731620198581985
stencil=4032, total_loss=0.00047895713655944335, total_rmsqb=0.2749022130093466
stencil=4059, total_loss=0.00046087845977148137, total_rmsqb=0.2696640899208294
stencil=4061, total_loss=0.0005092162952213437, total_rmsqb=0.28345300017037633
stencil=4067, total_loss=0.0005337667157392546, total_rmsqb=0.2902055114288081
stencil=4069, total_loss=0.00046751627301894785, total_rmsqb=0.27159906949341117
[2, 1, 14, 1536]
stencil=2019, total_loss=0.0007700883926988983, total_rmsqb=0.36692440197761494
stencil=2082, total_loss=0.0007085243053766918, total_rmsqb=0.351952198851668
stencil=2084, total_loss=0.00076479163921924, total_rmsqb=0.3656603512658898
[2, 1, 7, 1536]
stencil=2019, total_loss=0.0006127504286400761, total_rmsqb=0.3445279919665846
stencil=2082, total_loss=0.00028609132921591287, total_rmsqb=0.2354154972764563
stencil=2084, total_loss=0.0006845433303788723, total_rmsqb=0.3641523968034786
[2, 1, 4, 1536]
stencil=2019, total_loss=0.0006978595660110234, total_rmsqb=0.3870286488437348
stencil=2082, total_loss=0.00033185669804553094, total_rmsqb=0.2668912831147874
stencil=2084, total_loss=0.0007513191015017947, total_rmsqb=0.40157929319909086
[2, 1, 2, 1536]
stencil=2019, total_loss=0.0008328133765848965, total_rmsqb=0.44505054435099056
stencil=2082, total_loss=0.0004893237130380694, total_rmsqb=0.341140767153951
stencil=2084, total_loss=0.0007184163479141189, total_rmsqb=0.4133553791731373
[2, 1, 1, 1536]
stencil=1006, total_loss=0.0005966787095504091, total_rmsqb=0.3965355751582918
[1, 1, 1, 768]
stencil=1014, total_loss=0.0005658402020344511, total_rmsqb=0.40647625439766505
[1, 1, 1, 384]
stencil=1014, total_loss=0.000718094034689582, total_rmsqb=0.48200920723566093
[1, 1, 1, 192]
stencil=1014, total_loss=0.0006435880321078002, total_rmsqb=0.48033590260740466
[1, 1, 1, 96]
stencil=1014, total_loss=0.0005975440584330095, total_rmsqb=0.4871945599151924
[1, 1, 1, 48]
stencil=1014, total_loss=0.0007652702223923471, total_rmsqb=0.5803650701623944
[1, 1, 1, 24]
stencil=1014, total_loss=0.0005148731512375749, total_rmsqb=0.5010953541340369
[1, 1, 1, 12]
stencil=1014, total_loss=0.00012993941513391642, total_rmsqb=0.26498244437456264
[1, 1, 1, 6]
stencil=1014, total_loss=4.8764661187306046e-05, total_rmsqb=0.17087386719842965
[1, 1, 1, 3]
stencil=1014, total_loss=6.482955541287083e-06, total_rmsqb=0.065582196673356
[1, 1, 1, 2]
stencil=1014, total_loss=3.692360769491643e-05, total_rmsqb=0.1647509381608381
[1, 1, 1, 1]
python3 -u /u/zjian1/ASTZ/py_code/compress.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -z '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_3.0e-02.astz' -c '/u/zjian1/ASTZ/stencil_list/3.0e-02/16_11_27_1536_0035.bin.txt' -E REL 3.0e-02 -4 16 11 27 1536 -M FHDE_gpu 9 -a 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
torch.Size([1, 1, 1, 1, 1, 96])
torch.Size([1, 1, 1, 1, 1, 192])
torch.Size([1, 1, 1, 1, 1, 384])
torch.Size([1, 1, 1, 1, 1, 768])
torch.Size([1, 1, 2, 1, 1, 1536])
torch.Size([1, 1, 2, 1, 2, 1536])
torch.Size([1, 1, 2, 1, 4, 1536])
torch.Size([1, 1, 2, 1, 7, 1536])
torch.Size([1, 1, 2, 1, 14, 1536])
torch.Size([1, 1, 2, 2, 14, 1536])
torch.Size([1, 1, 2, 3, 14, 1536])
torch.Size([1, 1, 2, 3, 14, 1536])
torch.Size([1, 1, 4, 3, 14, 1536])
torch.Size([1, 1, 8, 3, 14, 1536])
torch.Size([1, 1, 8, 6, 14, 1536])
torch.Size([1, 1, 16, 6, 14, 1536])
torch.Size([1, 1, 16, 11, 14, 1536])
torch.Size([1, 1, 16, 11, 27, 1536])
Huffman CR= 31.279
Zstd CR= 8.623
[31mTotal CR= 269.727 [0m
qb_min= -6, qb_max= 20
max_err= 3.644895553588867
max_rel_err= 0.030
[31mpsnr= 42.595 [0m
====================================== BEGIN TUNING ================================
Tuning time = 1.8375e-05s
====================================== END TUNING ======================================
prediction time = 0.126315s
compression ratio = 117.64 
compression time = 0.166599
compressed data file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_3.0e-02.qoz2
Min=-30.5, Max=91, range=121.5
Max absolute error = 3.6
Max relative error = 0.03
Max pw relative error = 1.8E+07
PSNR = 39.105911, NRMSE= 0.01108420195
normError = 3638.434255, normErr_norm = 0.909409
acEff=0.489214
compression ratio = 117.643479
decompression time = 0.069341 seconds.
decompressed file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_3.0e-02.qoz2.bin
type=float nx=27 ny=11 nz=16 nw=1 raw=19008 zfp=4696 ratio=4.05 rate=7.906 rmse=0.08857 nrmse=0.001001 maxe=0.4814 psnr=53.97
cuSZp finished!
cuSZp compression   end-to-end speed: 64.572704 GB/s
cuSZp decompression end-to-end speed: 81.924224 GB/s
cuSZp compression ratio: 54.393561

[0;32mPass error check![0m
command= python3 -u /u/zjian1/ASTZ/py_code/generate_stencil_list.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -c '/u/zjian1/ASTZ/stencil_list/2.0e-02/16_11_27_1536_0035.bin.txt' -E REL 2.0e-02 -4 16 11 27 1536 -M FHDE 9 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
stencil=8000, total_loss=0.0002442942791921542, total_rmsqb=0.19537395200940705
stencil=8001, total_loss=0.00024090650836329969, total_rmsqb=0.1940145405163375
stencil=8002, total_loss=0.0002444128840988501, total_rmsqb=0.19542137329485054
stencil=8003, total_loss=0.00023912179216280144, total_rmsqb=0.19329454215118885
stencil=8004, total_loss=0.0002966207109490967, total_rmsqb=0.21528350165722487
stencil=8005, total_loss=0.00029507010962452043, total_rmsqb=0.21472006107681535
stencil=8006, total_loss=0.0002941171127538785, total_rmsqb=0.21437303670889563
stencil=8007, total_loss=0.0002827846468068439, total_rmsqb=0.21020252392292857
stencil=8008, total_loss=0.0002439069560080279, total_rmsqb=0.19521901002785144
stencil=8009, total_loss=0.00022714683629995592, total_rmsqb=0.18839239149145093
stencil=8010, total_loss=0.00024208816665013085, total_rmsqb=0.19448978389386662
stencil=8011, total_loss=0.00019297023842396941, total_rmsqb=0.1736421600699128
stencil=8012, total_loss=0.0002903124664309825, total_rmsqb=0.21298197782873793
stencil=8013, total_loss=0.00019703553835414173, total_rmsqb=0.17546168489968014
stencil=8014, total_loss=0.00020447203278778033, total_rmsqb=0.17874214702495514
[16, 11, 14, 1536]
stencil=8000, total_loss=0.0003178720806231486, total_rmsqb=0.23459167708069115
stencil=8001, total_loss=0.0003188560149250983, total_rmsqb=0.2349544715301635
stencil=8002, total_loss=0.0003173669076357359, total_rmsqb=0.23440519247291544
stencil=8003, total_loss=0.0003233715663708114, total_rmsqb=0.23661230312349865
stencil=8004, total_loss=0.00031933432987904883, total_rmsqb=0.23513063274006624
stencil=8005, total_loss=0.00031866182042649804, total_rmsqb=0.23488291287537352
stencil=8006, total_loss=0.00031956054021602055, total_rmsqb=0.23521389902012024
stencil=8007, total_loss=0.00030703365601700516, total_rmsqb=0.23055757719458295
stencil=8008, total_loss=0.0003193852611505564, total_rmsqb=0.23514938272012517
stencil=8009, total_loss=0.00031864773129865805, total_rmsqb=0.23487772032993123
stencil=8010, total_loss=0.00030995416894622944, total_rmsqb=0.23165151709319134
stencil=8011, total_loss=0.0003407439533195069, total_rmsqb=0.2428848836598131
stencil=8012, total_loss=0.0003182288850913283, total_rmsqb=0.23472330217150084
stencil=8013, total_loss=0.00020148538010461583, total_rmsqb=0.1867704551761317
stencil=8014, total_loss=0.0002096283705065047, total_rmsqb=0.19050721884997335
[16, 6, 14, 1536]
stencil=8000, total_loss=0.0003579962857192561, total_rmsqb=0.26206080021123757
stencil=8001, total_loss=0.0003649658260324524, total_rmsqb=0.2645994290858748
stencil=8002, total_loss=0.00036750347332510826, total_rmsqb=0.26551772996986767
stencil=8003, total_loss=0.00036558553449916637, total_rmsqb=0.2648239774504751
stencil=8004, total_loss=0.00036392610766755086, total_rmsqb=0.2642222635008233
stencil=8005, total_loss=0.0003607763966845785, total_rmsqb=0.2630763821434942
stencil=8006, total_loss=0.00036297608685013677, total_rmsqb=0.2638771650344833
stencil=8007, total_loss=0.00035031250804783246, total_rmsqb=0.2592332022054876
stencil=8008, total_loss=0.0003545674750114887, total_rmsqb=0.26080280002370565
stencil=8009, total_loss=0.0003691978464228532, total_rmsqb=0.26612911023393204
stencil=8010, total_loss=0.000352047073140635, total_rmsqb=0.2598742036117484
stencil=8011, total_loss=0.0003667695548227728, total_rmsqb=0.26525247293688387
stencil=8012, total_loss=0.00036481918480556154, total_rmsqb=0.26454626646014956
stencil=8013, total_loss=0.0002243316316072212, total_rmsqb=0.20744743052501538
stencil=8014, total_loss=0.00021982885825232428, total_rmsqb=0.20535493995332735
[8, 6, 14, 1536]
stencil=8000, total_loss=0.00036171652285901855, total_rmsqb=0.27728308088020887
stencil=8001, total_loss=0.0003675461203177892, total_rmsqb=0.2795085637308
stencil=8002, total_loss=0.00036501987436339956, total_rmsqb=0.27854633770702847
stencil=8003, total_loss=0.00036774043052388426, total_rmsqb=0.2795824377119633
stencil=8004, total_loss=0.00036603376746765983, total_rmsqb=0.27893291990463814
stencil=8005, total_loss=0.00035981775262802264, total_rmsqb=0.27655434776336374
stencil=8006, total_loss=0.0003633705583654815, total_rmsqb=0.27791632946256073
stencil=8007, total_loss=0.0003468519107271822, total_rmsqb=0.27152588805457506
stencil=8008, total_loss=0.00037302336908841684, total_rmsqb=0.28158350939084553
stencil=8009, total_loss=0.0003606810180066894, total_rmsqb=0.27688590001300256
stencil=8010, total_loss=0.0003629140552111154, total_rmsqb=0.27774170118044583
stencil=8011, total_loss=0.00035848691469791624, total_rmsqb=0.2760424358795264
stencil=8012, total_loss=0.00036013941414498967, total_rmsqb=0.27667793396548046
stencil=8013, total_loss=0.00022565968179336058, total_rmsqb=0.21901112842858306
stencil=8014, total_loss=0.0002415689040587798, total_rmsqb=0.22659989884182297
[8, 3, 14, 1536]
stencil=8000, total_loss=0.0004752793456262337, total_rmsqb=0.33457236215103753
stencil=8001, total_loss=0.0004759897245513879, total_rmsqb=0.33482230401536317
stencil=8002, total_loss=0.00048379892043529945, total_rmsqb=0.33755771571948934
stencil=8003, total_loss=0.00047923482081391465, total_rmsqb=0.3359617036294502
stencil=8004, total_loss=0.0004821401052258485, total_rmsqb=0.33697852191658584
stencil=8005, total_loss=0.0004769025142379073, total_rmsqb=0.3351431890576555
stencil=8006, total_loss=0.00047937973466772655, total_rmsqb=0.336012494831587
stencil=8007, total_loss=0.00046001773233451455, total_rmsqb=0.3291568353945002
stencil=8008, total_loss=0.000504133216847353, total_rmsqb=0.3445785575558519
stencil=8009, total_loss=0.00044980610725198515, total_rmsqb=0.32548296663330895
stencil=8010, total_loss=0.00048673951075088844, total_rmsqb=0.3385820206103685
stencil=8011, total_loss=0.0004501321852574451, total_rmsqb=0.3256009214666314
stencil=8012, total_loss=0.0004957887725521671, total_rmsqb=0.3417149154800373
stencil=8013, total_loss=0.00030820843689470463, total_rmsqb=0.2694249762908608
stencil=8014, total_loss=0.0002860665178048103, total_rmsqb=0.25956677820271196
[4, 3, 14, 1536]
stencil=8000, total_loss=0.0004829052102107356, total_rmsqb=0.3549955688789774
stencil=8001, total_loss=0.00047708211939814153, total_rmsqb=0.35284872828441477
stencil=8002, total_loss=0.0004877954766131949, total_rmsqb=0.35678851903568676
stencil=8003, total_loss=0.00048617419712242594, total_rmsqb=0.35619509885594464
stencil=8004, total_loss=0.00048054184603650774, total_rmsqb=0.35412581968249346
stencil=8005, total_loss=0.00048185557783356843, total_rmsqb=0.35460955364015395
stencil=8006, total_loss=0.0004861492938946747, total_rmsqb=0.356185976075141
stencil=8007, total_loss=0.00046168007253092664, total_rmsqb=0.3471063440500408
stencil=8008, total_loss=0.0005019923296835708, total_rmsqb=0.3619432878938378
stencil=8009, total_loss=0.0004744743732759394, total_rmsqb=0.35188306567393524
stencil=8010, total_loss=0.0005111354605066791, total_rmsqb=0.3652245749847806
stencil=8011, total_loss=0.0004627914775431067, total_rmsqb=0.3475238884303287
stencil=8012, total_loss=0.00046779272911904213, total_rmsqb=0.3493966367632019
stencil=8013, total_loss=0.0003284477500227699, total_rmsqb=0.29276902886531925
stencil=8014, total_loss=0.00028709336122459183, total_rmsqb=0.27371812825682035
[2, 3, 14, 1536]
stencil=8000, total_loss=0.00027073052325109925, total_rmsqb=0.27979309515476264
stencil=8001, total_loss=0.00044399279424825304, total_rmsqb=0.35830786580597085
stencil=8002, total_loss=0.0002684457616161966, total_rmsqb=0.27860997224269507
stencil=8003, total_loss=0.0004541462178114884, total_rmsqb=0.3623816783858094
stencil=8004, total_loss=0.00026579755790571974, total_rmsqb=0.2772323296641767
stencil=8005, total_loss=0.00045157454107459983, total_rmsqb=0.36135419919144335
stencil=8006, total_loss=0.00026351729250599025, total_rmsqb=0.276040586281857
stencil=8007, total_loss=0.0004296703615699945, total_rmsqb=0.3524812986898987
stencil=8008, total_loss=0.0002578675966914736, total_rmsqb=0.2730654586372216
stencil=8009, total_loss=0.0004535561221463246, total_rmsqb=0.36214617123236165
stencil=8010, total_loss=0.00026231573683607154, total_rmsqb=0.27541053828812834
stencil=8011, total_loss=0.00044537345088209554, total_rmsqb=0.35886453716479505
stencil=8012, total_loss=0.00026625213021302084, total_rmsqb=0.2774692925342927
stencil=8013, total_loss=0.0003025698573580373, total_rmsqb=0.29578844996592024
stencil=8014, total_loss=0.00026596501208765787, total_rmsqb=0.27731964499511663
[2, 3, 14, 1536]
stencil=4002, total_loss=0.0004542372997790907, total_rmsqb=0.38149264795916193
stencil=4015, total_loss=0.0002868442148694593, total_rmsqb=0.30315715564634527
stencil=4016, total_loss=0.0004521276985659088, total_rmsqb=0.38060573933913117
stencil=4077, total_loss=0.0004326178552994524, total_rmsqb=0.37230339452368655
stencil=4078, total_loss=0.00044858265223300756, total_rmsqb=0.37911067474065396
stencil=4081, total_loss=0.0004413064738092945, total_rmsqb=0.37602344607759297
stencil=4082, total_loss=0.0004523492393502199, total_rmsqb=0.38069897557274895
[2, 2, 14, 1536]
stencil=4001, total_loss=0.00048152435733706634, total_rmsqb=0.41345695404137883
stencil=4034, total_loss=0.0001697680278087215, total_rmsqb=0.2454986580099758
stencil=4036, total_loss=0.000513828332699804, total_rmsqb=0.4271006128288391
stencil=4085, total_loss=0.0004696855379508353, total_rmsqb=0.40834267055020873
stencil=4086, total_loss=0.0004956066129155771, total_rmsqb=0.4194591930082173
stencil=4089, total_loss=0.00044445680597653755, total_rmsqb=0.39722443059717716
stencil=4090, total_loss=0.0004542579106934887, total_rmsqb=0.40158031887594575
[2, 1, 14, 1536]
stencil=2014, total_loss=0.0007389633169640107, total_rmsqb=0.5391492500166608
stencil=2095, total_loss=0.0007431892602408388, total_rmsqb=0.5406886809730638
stencil=2096, total_loss=0.0007454738722550363, total_rmsqb=0.5415190993190693
[1, 1, 7, 1536]
stencil=2090, total_loss=0.0003570633534708935, total_rmsqb=0.3944996296699656
stencil=2103, total_loss=0.0005821424063657546, total_rmsqb=0.5037192853151526
stencil=2104, total_loss=0.0005633864036322366, total_rmsqb=0.49553820235983415
[1, 1, 4, 1536]
stencil=2090, total_loss=0.00035180354380928393, total_rmsqb=0.4121928553676091
stencil=2103, total_loss=0.000612280223449863, total_rmsqb=0.5437828052931488
stencil=2104, total_loss=0.000557553809502714, total_rmsqb=0.5189120413074049
[1, 1, 2, 1536]
stencil=2090, total_loss=0.0004730459865337859, total_rmsqb=0.5031279343477582
stencil=2103, total_loss=0.0006558234930473238, total_rmsqb=0.5924070722299032
stencil=2104, total_loss=0.0004999888104309018, total_rmsqb=0.5172576138984497
[1, 1, 1, 1536]
stencil=1014, total_loss=0.0005538991665330384, total_rmsqb=0.5730842857821402
[1, 1, 1, 768]
stencil=1014, total_loss=0.000515634717562029, total_rmsqb=0.5820370277551505
[1, 1, 1, 384]
stencil=1014, total_loss=0.0006646193284217993, total_rmsqb=0.6955725221062834
[1, 1, 1, 192]
stencil=1014, total_loss=0.0005989098442821867, total_rmsqb=0.6950452092381572
[1, 1, 1, 96]
stencil=1014, total_loss=0.0005597128843267758, total_rmsqb=0.7072799962121791
[1, 1, 1, 48]
stencil=1014, total_loss=0.000698130660586887, total_rmsqb=0.8314831903015985
[1, 1, 1, 24]
stencil=1014, total_loss=0.00048467716148409707, total_rmsqb=0.7292690631066031
[1, 1, 1, 12]
stencil=1014, total_loss=7.078793043127426e-05, total_rmsqb=0.29337122543350325
[1, 1, 1, 6]
stencil=1014, total_loss=2.7743048849515618e-05, total_rmsqb=0.19332650299251455
[1, 1, 1, 3]
stencil=1014, total_loss=6.482955541287083e-06, total_rmsqb=0.09837329501003401
[1, 1, 1, 2]
stencil=1014, total_loss=8.09994526207447e-06, total_rmsqb=0.11574657086433722
[1, 1, 1, 1]
python3 -u /u/zjian1/ASTZ/py_code/compress.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -z '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_2.0e-02.astz' -c '/u/zjian1/ASTZ/stencil_list/2.0e-02/16_11_27_1536_0035.bin.txt' -E REL 2.0e-02 -4 16 11 27 1536 -M FHDE_gpu 9 -a 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
torch.Size([1, 1, 1, 1, 1, 96])
torch.Size([1, 1, 1, 1, 1, 192])
torch.Size([1, 1, 1, 1, 1, 384])
torch.Size([1, 1, 1, 1, 1, 768])
torch.Size([1, 1, 1, 1, 1, 1536])
torch.Size([1, 1, 1, 1, 2, 1536])
torch.Size([1, 1, 1, 1, 4, 1536])
torch.Size([1, 1, 1, 1, 7, 1536])
torch.Size([1, 1, 2, 1, 14, 1536])
torch.Size([1, 1, 2, 2, 14, 1536])
torch.Size([1, 1, 2, 3, 14, 1536])
torch.Size([1, 1, 2, 3, 14, 1536])
torch.Size([1, 1, 4, 3, 14, 1536])
torch.Size([1, 1, 8, 3, 14, 1536])
torch.Size([1, 1, 8, 6, 14, 1536])
torch.Size([1, 1, 16, 6, 14, 1536])
torch.Size([1, 1, 16, 11, 14, 1536])
torch.Size([1, 1, 16, 11, 27, 1536])
Huffman CR= 30.283
Zstd CR= 3.686
[31mTotal CR= 111.626 [0m
qb_min= -9, qb_max= 24
max_err= 2.429994583129883
max_rel_err= 0.020
[31mpsnr= 43.717 [0m
====================================== BEGIN TUNING ================================
Tuning time = 1.8805e-05s
====================================== END TUNING ======================================
prediction time = 0.132023s
compression ratio = 60.68 
compression time = 0.179369
compressed data file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_2.0e-02.qoz2
Min=-30.5, Max=91, range=121.5
Max absolute error = 2.4
Max relative error = 0.02
Max pw relative error = 1.6E+07
PSNR = 41.041633, NRMSE= 0.0088698928
normError = 2911.578293, normErr_norm = 0.780093
acEff=0.644759
compression ratio = 60.677572
decompression time = 0.077142 seconds.
decompressed file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_2.0e-02.qoz2.bin
type=float nx=27 ny=11 nz=16 nw=1 raw=19008 zfp=4696 ratio=4.05 rate=7.906 rmse=0.08857 nrmse=0.001001 maxe=0.4814 psnr=53.97
cuSZp finished!
cuSZp compression   end-to-end speed: 62.036017 GB/s
cuSZp decompression end-to-end speed: 78.135523 GB/s
cuSZp compression ratio: 32.189528

[0;32mPass error check![0m
command= python3 -u /u/zjian1/ASTZ/py_code/generate_stencil_list.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -c '/u/zjian1/ASTZ/stencil_list/1.0e-02/16_11_27_1536_0035.bin.txt' -E REL 1.0e-02 -4 16 11 27 1536 -M FHDE 9 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
stencil=8000, total_loss=0.00022299764856770264, total_rmsqb=0.37332764477709673
stencil=8001, total_loss=0.00022443484759029978, total_rmsqb=0.3745287435483922
stencil=8002, total_loss=0.00022372974826096525, total_rmsqb=0.37393995863387386
stencil=8003, total_loss=0.00022224729382686747, total_rmsqb=0.37269901883663736
stencil=8004, total_loss=0.0002696554872872482, total_rmsqb=0.41052975477367054
stencil=8005, total_loss=0.00026982821613759735, total_rmsqb=0.41066121692460605
stencil=8006, total_loss=0.00027010039112040045, total_rmsqb=0.4108682811440307
stencil=8007, total_loss=0.00025736423035176766, total_rmsqb=0.40106438880790046
stencil=8008, total_loss=0.00022534888524099753, total_rmsqb=0.37529062508357897
stencil=8009, total_loss=0.0002134620694569995, total_rmsqb=0.36525852955218535
stencil=8010, total_loss=0.0002262119756742549, total_rmsqb=0.37600862330059576
stencil=8011, total_loss=0.00018029990088408947, total_rmsqb=0.33568949648828145
stencil=8012, total_loss=0.0002681079513885489, total_rmsqb=0.4093500575520212
stencil=8013, total_loss=0.00018420184580254063, total_rmsqb=0.33930245154815475
stencil=8014, total_loss=0.00019342960188710142, total_rmsqb=0.3476974276284459
[16, 11, 14, 1536]
stencil=8000, total_loss=0.00029182652233735216, total_rmsqb=0.4495508086929711
stencil=8001, total_loss=0.0002955350872957432, total_rmsqb=0.45239826246122844
stencil=8002, total_loss=0.0002928079465640029, total_rmsqb=0.4503061028491174
stencil=8003, total_loss=0.00029680837990246124, total_rmsqb=0.45337177841318954
stencil=8004, total_loss=0.00029331135499222543, total_rmsqb=0.4506930297423379
stencil=8005, total_loss=0.00029473151535588314, total_rmsqb=0.4517827991578227
stencil=8006, total_loss=0.00029274135882549775, total_rmsqb=0.4502548976644711
stencil=8007, total_loss=0.0002823605858539438, total_rmsqb=0.4421996968802825
stencil=8008, total_loss=0.0002906271508506328, total_rmsqb=0.4486260580085166
stencil=8009, total_loss=0.0002932130370030238, total_rmsqb=0.45061748724188266
stencil=8010, total_loss=0.0002880539595889937, total_rmsqb=0.44663559141197384
stencil=8011, total_loss=0.0003201964270087667, total_rmsqb=0.4708956126190926
stencil=8012, total_loss=0.0002925793934965786, total_rmsqb=0.45013032392367897
stencil=8013, total_loss=0.0001905332001637141, total_rmsqb=0.3632467474862766
stencil=8014, total_loss=0.00019898146312993207, total_rmsqb=0.371212603748032
[16, 6, 14, 1536]
stencil=8000, total_loss=0.0003324749276848525, total_rmsqb=0.5050940449395107
stencil=8001, total_loss=0.0003353565459220192, total_rmsqb=0.5072781916845367
stencil=8002, total_loss=0.00033303443843341106, total_rmsqb=0.505518869079283
stencil=8003, total_loss=0.00033751666251939606, total_rmsqb=0.5089093230363951
stencil=8004, total_loss=0.00033353732879368245, total_rmsqb=0.5059003981936924
stencil=8005, total_loss=0.00033127182108601884, total_rmsqb=0.5041793402954401
stencil=8006, total_loss=0.0003317384052925691, total_rmsqb=0.5045342744134232
stencil=8007, total_loss=0.00032136306077448014, total_rmsqb=0.49658177401835235
stencil=8008, total_loss=0.00032557240222652525, total_rmsqb=0.4998234065005466
stencil=8009, total_loss=0.0003407783800154341, total_rmsqb=0.5113624276955118
stencil=8010, total_loss=0.00032558960144855593, total_rmsqb=0.49983660857196693
stencil=8011, total_loss=0.0003456118961520179, total_rmsqb=0.5149761776894313
stencil=8012, total_loss=0.00033651177115849985, total_rmsqb=0.5081511681737949
stencil=8013, total_loss=0.00020683286219239322, total_rmsqb=0.39838462483800824
stencil=8014, total_loss=0.00020632368647625977, total_rmsqb=0.397893956262102
[8, 6, 14, 1536]
stencil=8000, total_loss=0.0003315589224716814, total_rmsqb=0.5309450210943419
stencil=8001, total_loss=0.0003322776794529538, total_rmsqb=0.531520203691437
stencil=8002, total_loss=0.0003337775785202394, total_rmsqb=0.5327184921456194
stencil=8003, total_loss=0.0003322871710999185, total_rmsqb=0.5315277951825489
stencil=8004, total_loss=0.0003326796177716291, total_rmsqb=0.531841582138718
stencil=8005, total_loss=0.0003285891048933212, total_rmsqb=0.5285617996269075
stencil=8006, total_loss=0.00032889720775903207, total_rmsqb=0.5288095455899774
stencil=8007, total_loss=0.00031793819495601913, total_rmsqb=0.5199248137785536
stencil=8008, total_loss=0.0003392339625681879, total_rmsqb=0.5370551128410223
stencil=8009, total_loss=0.0003300455684989218, total_rmsqb=0.5297319233982642
stencil=8010, total_loss=0.000332649293766011, total_rmsqb=0.5318173426996451
stencil=8011, total_loss=0.0003353339547776229, total_rmsqb=0.5339590580126502
stencil=8012, total_loss=0.000326298878453375, total_rmsqb=0.5267165727478046
stencil=8013, total_loss=0.00020766013014956178, total_rmsqb=0.4201900398776266
stencil=8014, total_loss=0.00022736580607931136, total_rmsqb=0.43967499599507986
[8, 3, 14, 1536]
stencil=8000, total_loss=0.00043317297395928844, total_rmsqb=0.6388167043125172
stencil=8001, total_loss=0.00043461254487435025, total_rmsqb=0.6398773189180775
stencil=8002, total_loss=0.0004354249746152117, total_rmsqb=0.640475107285408
stencil=8003, total_loss=0.00043650587045532306, total_rmsqb=0.6412695699597236
stencil=8004, total_loss=0.00043731870173227284, total_rmsqb=0.6418663563584467
stencil=8005, total_loss=0.0004328352513938512, total_rmsqb=0.6385676295820097
stencil=8006, total_loss=0.00043511527919020174, total_rmsqb=0.6402472982435427
stencil=8007, total_loss=0.00042183194449635326, total_rmsqb=0.6303987160901865
stencil=8008, total_loss=0.00045433499826362257, total_rmsqb=0.6542348639687763
stencil=8009, total_loss=0.0004036392311083595, total_rmsqb=0.6166550218678215
stencil=8010, total_loss=0.00044274077701706506, total_rmsqb=0.6458331735004871
stencil=8011, total_loss=0.00042064716151548617, total_rmsqb=0.6295128054156877
stencil=8012, total_loss=0.00044629643001457885, total_rmsqb=0.6484213319477031
stencil=8013, total_loss=0.0002731355474233792, total_rmsqb=0.5072647688235027
stencil=8014, total_loss=0.00026825516051257406, total_rmsqb=0.5027124375711438
[4, 3, 14, 1536]
stencil=8000, total_loss=0.00043353145845709235, total_rmsqb=0.672716826342821
stencil=8001, total_loss=0.00043579874112837925, total_rmsqb=0.6744736195317051
stencil=8002, total_loss=0.00043542795866344567, total_rmsqb=0.6741866336095678
stencil=8003, total_loss=0.0004378819473907334, total_rmsqb=0.676083757893603
stencil=8004, total_loss=0.0004340752315104362, total_rmsqb=0.6731385842581957
stencil=8005, total_loss=0.00043347102036032985, total_rmsqb=0.6726699333885026
stencil=8006, total_loss=0.0004360313875566646, total_rmsqb=0.6746536257222296
stencil=8007, total_loss=0.0004210678474058259, total_rmsqb=0.6629763285617238
stencil=8008, total_loss=0.00045407612733108793, total_rmsqb=0.6884720552488609
stencil=8009, total_loss=0.0004188700767151972, total_rmsqb=0.6612438569055361
stencil=8010, total_loss=0.0004637841568361933, total_rmsqb=0.6957928099672233
stencil=8011, total_loss=0.000426656112728448, total_rmsqb=0.6673612228921243
stencil=8012, total_loss=0.0004235481644328701, total_rmsqb=0.6649261057816976
stencil=8013, total_loss=0.00028942412190351494, total_rmsqb=0.5496539387276534
stencil=8014, total_loss=0.00027021032475722806, total_rmsqb=0.5310959039304138
[2, 3, 14, 1536]
stencil=8000, total_loss=0.00024631023978116543, total_rmsqb=0.5337521168539778
stencil=8001, total_loss=0.00039652325685721044, total_rmsqb=0.6772245748831118
stencil=8002, total_loss=0.00024626759976891904, total_rmsqb=0.5337059145891134
stencil=8003, total_loss=0.00039937292168485436, total_rmsqb=0.6796536986734404
stencil=8004, total_loss=0.000244554328279076, total_rmsqb=0.5318461916415824
stencil=8005, total_loss=0.0003979940356467073, total_rmsqb=0.6784793885676608
stencil=8006, total_loss=0.0002446391853812158, total_rmsqb=0.5319384554192171
stencil=8007, total_loss=0.00038876065133779065, total_rmsqb=0.6705629089261804
stencil=8008, total_loss=0.0002406353899947239, total_rmsqb=0.5275676126877848
stencil=8009, total_loss=0.0003960058311074399, total_rmsqb=0.6767825732902776
stencil=8010, total_loss=0.00024355597846604287, total_rmsqb=0.5307594974191526
stencil=8011, total_loss=0.0004126155038642031, total_rmsqb=0.690829935012155
stencil=8012, total_loss=0.00024648405839708024, total_rmsqb=0.5339404153434566
stencil=8013, total_loss=0.00026418976644484657, total_rmsqb=0.5527851560531836
stencil=8014, total_loss=0.0002503139895037016, total_rmsqb=0.5380726752272553
[2, 3, 14, 1536]
stencil=4002, total_loss=0.00039329091241531157, total_rmsqb=0.7099564798515559
stencil=4015, total_loss=0.0002536257271873605, total_rmsqb=0.5701267578165704
stencil=4016, total_loss=0.00041389764356826827, total_rmsqb=0.7283183440008926
stencil=4077, total_loss=0.0003896412523486028, total_rmsqb=0.7066546757590002
stencil=4078, total_loss=0.00039780970811698855, total_rmsqb=0.7140234256969564
stencil=4081, total_loss=0.0003955493001335294, total_rmsqb=0.7119919474870893
stencil=4082, total_loss=0.00040120891017826225, total_rmsqb=0.7170675283121974
[2, 2, 14, 1536]
stencil=4001, total_loss=0.0004513485499137529, total_rmsqb=0.8005845268667456
stencil=4034, total_loss=0.00015485935920883632, total_rmsqb=0.46894282490965106
stencil=4036, total_loss=0.0004715422753358556, total_rmsqb=0.8182979887415663
stencil=4085, total_loss=0.00043070939806221566, total_rmsqb=0.7820658827974134
stencil=4086, total_loss=0.0004388508104378627, total_rmsqb=0.7894227150146191
stencil=4089, total_loss=0.00041492817264757425, total_rmsqb=0.7676047050045912
stencil=4090, total_loss=0.0004168285567731763, total_rmsqb=0.7693605237619834
[2, 1, 14, 1536]
stencil=2014, total_loss=0.0006895857601341906, total_rmsqb=1.041649724818205
stencil=2095, total_loss=0.0006588567405881366, total_rmsqb=1.018176473515321
stencil=2096, total_loss=0.0006677041061816032, total_rmsqb=1.024989896702958
[2, 1, 14, 768]
stencil=2014, total_loss=0.0006842039959086097, total_rmsqb=1.0921863862715127
stencil=2095, total_loss=0.0006232672282887626, total_rmsqb=1.0424160794302733
stencil=2096, total_loss=0.0006576936385380396, total_rmsqb=1.0708182798740444
[2, 1, 14, 384]
stencil=2014, total_loss=0.0006820882717389581, total_rmsqb=1.1478909754120792
stencil=2095, total_loss=0.0006937424037303615, total_rmsqb=1.1576558503674608
stencil=2096, total_loss=0.0006575637980718021, total_rmsqb=1.1270658687723814
[2, 1, 14, 384]
stencil=1004, total_loss=0.0006045410824374791, total_rmsqb=1.137547799979655
[1, 1, 7, 192]
stencil=2090, total_loss=0.0003278445330913403, total_rmsqb=0.8817939462457175
stencil=2103, total_loss=0.00047117488493337553, total_rmsqb=1.0571197980584661
stencil=2104, total_loss=0.0004691406677460303, total_rmsqb=1.0548353625299434
[1, 1, 4, 192]
stencil=2090, total_loss=0.00024716634315322654, total_rmsqb=0.8059427645853786
stencil=2103, total_loss=0.0004931689607770913, total_rmsqb=1.1384328057416393
stencil=2104, total_loss=0.000434094301000207, total_rmsqb=1.068074574344969
[1, 1, 2, 192]
stencil=2090, total_loss=0.0004125280234881717, total_rmsqb=1.0960053076904746
stencil=2103, total_loss=0.0005061197838997537, total_rmsqb=1.2139829473474684
stencil=2104, total_loss=0.00040899745964755616, total_rmsqb=1.0913052251665527
[1, 1, 2, 192]
stencil=1012, total_loss=0.00016334791172423638, total_rmsqb=0.7259707407555366
[1, 1, 1, 96]
stencil=1014, total_loss=0.00031149589366660536, total_rmsqb=1.0552731341182884
[1, 1, 1, 48]
stencil=1014, total_loss=0.00043110044101591814, total_rmsqb=1.3067856206977266
[1, 1, 1, 24]
stencil=1014, total_loss=1.527579195681028e-05, total_rmsqb=0.2589365609779927
[1, 1, 1, 12]
stencil=1014, total_loss=4.180544951500801e-05, total_rmsqb=0.45090427378345066
[1, 1, 1, 6]
stencil=1014, total_loss=7.8372482676059e-06, total_rmsqb=0.20550675413753247
[1, 1, 1, 3]
stencil=1014, total_loss=6.482955541287083e-06, total_rmsqb=0.19674659002006803
[1, 1, 1, 2]
stencil=1014, total_loss=6.496650257759029e-07, total_rmsqb=0.06556043564515657
[1, 1, 1, 1]
python3 -u /u/zjian1/ASTZ/py_code/compress.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -z '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_1.0e-02.astz' -c '/u/zjian1/ASTZ/stencil_list/1.0e-02/16_11_27_1536_0035.bin.txt' -E REL 1.0e-02 -4 16 11 27 1536 -M FHDE_gpu 9 -a 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
torch.Size([1, 1, 1, 1, 1, 96])
torch.Size([1, 1, 1, 1, 2, 192])
torch.Size([1, 1, 1, 1, 2, 192])
torch.Size([1, 1, 1, 1, 4, 192])
torch.Size([1, 1, 1, 1, 7, 192])
torch.Size([1, 1, 2, 1, 14, 384])
torch.Size([1, 1, 2, 1, 14, 384])
torch.Size([1, 1, 2, 1, 14, 768])
torch.Size([1, 1, 2, 1, 14, 1536])
torch.Size([1, 1, 2, 2, 14, 1536])
torch.Size([1, 1, 2, 3, 14, 1536])
torch.Size([1, 1, 2, 3, 14, 1536])
torch.Size([1, 1, 4, 3, 14, 1536])
torch.Size([1, 1, 8, 3, 14, 1536])
torch.Size([1, 1, 8, 6, 14, 1536])
torch.Size([1, 1, 16, 6, 14, 1536])
torch.Size([1, 1, 16, 11, 14, 1536])
torch.Size([1, 1, 16, 11, 27, 1536])
Huffman CR= 25.774
Zstd CR= 1.501
[31mTotal CR= 38.677 [0m
qb_min= -19, qb_max= 42
max_err= 1.2150001525878906
max_rel_err= 0.010
[31mpsnr= 46.672 [0m
====================================== BEGIN TUNING ================================
Tuning time = 1.9016e-05s
====================================== END TUNING ======================================
prediction time = 0.135006s
compression ratio = 27.05 
compression time = 0.188264
compressed data file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_1.0e-02.qoz2
Min=-30.5, Max=91, range=121.5
Max absolute error = 1.2
Max relative error = 0.01
Max pw relative error = 4.2E+06
PSNR = 45.247630, NRMSE= 0.005465356588
normError = 1794.025470, normErr_norm = 0.525096
acEff=0.851354
compression ratio = 27.050081
decompression time = 0.097367 seconds.
decompressed file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_1.0e-02.qoz2.bin
type=float nx=27 ny=11 nz=16 nw=1 raw=19008 zfp=5368 ratio=3.54 rate=9.037 rmse=0.04446 nrmse=0.0005024 maxe=0.2346 psnr=59.96
cuSZp finished!
cuSZp compression   end-to-end speed: 62.018330 GB/s
cuSZp decompression end-to-end speed: 76.279231 GB/s
cuSZp compression ratio: 14.568192

[0;32mPass error check![0m
command= python3 -u /u/zjian1/ASTZ/py_code/generate_stencil_list.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -c '/u/zjian1/ASTZ/stencil_list/6.0e-03/16_11_27_1536_0035.bin.txt' -E REL 6.0e-03 -4 16 11 27 1536 -M FHDE 9 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
stencil=8000, total_loss=0.00021037127675988372, total_rmsqb=0.604340889764597
stencil=8001, total_loss=0.00021073706647972877, total_rmsqb=0.6048660700009697
stencil=8002, total_loss=0.0002104299218494801, total_rmsqb=0.6044251197899746
stencil=8003, total_loss=0.0002103089985806443, total_rmsqb=0.6042514287964137
stencil=8004, total_loss=0.00024738830156469143, total_rmsqb=0.6553575963589398
stencil=8005, total_loss=0.0002464028811199076, total_rmsqb=0.6540510528407256
stencil=8006, total_loss=0.00024719107977728077, total_rmsqb=0.6550963136584499
stencil=8007, total_loss=0.00023800227527439298, total_rmsqb=0.6428050984346646
stencil=8008, total_loss=0.0002119463700064714, total_rmsqb=0.6065990833556392
stencil=8009, total_loss=0.00020323619321298983, total_rmsqb=0.594003883166597
stencil=8010, total_loss=0.00021328509144312254, total_rmsqb=0.6085118052172483
stencil=8011, total_loss=0.00017147959550254828, total_rmsqb=0.545625907633438
stencil=8012, total_loss=0.00024596349788827935, total_rmsqb=0.653467643890343
stencil=8013, total_loss=0.0001755277476658771, total_rmsqb=0.552028688594204
stencil=8014, total_loss=0.00018676112075804915, total_rmsqb=0.5694190520799361
[16, 11, 14, 1536]
stencil=8000, total_loss=0.00026649924953598124, total_rmsqb=0.7160002075412424
stencil=8001, total_loss=0.0002671344214091091, total_rmsqb=0.7168529539086282
stencil=8002, total_loss=0.0002665848830691307, total_rmsqb=0.7161152335740868
stencil=8003, total_loss=0.00026711321675148447, total_rmsqb=0.7168245020845686
stencil=8004, total_loss=0.00026684380873712496, total_rmsqb=0.7164629194811073
stencil=8005, total_loss=0.000266554961386008, total_rmsqb=0.7160750437963668
stencil=8006, total_loss=0.00026603274482637975, total_rmsqb=0.7153732568626745
stencil=8007, total_loss=0.0002583550197066385, total_rmsqb=0.7049748195530858
stencil=8008, total_loss=0.00026476054761358144, total_rmsqb=0.7136607110677057
stencil=8009, total_loss=0.00026559468405875747, total_rmsqb=0.7147840322739832
stencil=8010, total_loss=0.00026212359397032926, total_rmsqb=0.710097870025853
stencil=8011, total_loss=0.00029437680720414316, total_rmsqb=0.7525180965902907
stencil=8012, total_loss=0.0002658347429755867, total_rmsqb=0.7151069896507826
stencil=8013, total_loss=0.00018368501521959802, total_rmsqb=0.594431776316789
stencil=8014, total_loss=0.00019243143744745742, total_rmsqb=0.6084195562534991
[16, 6, 14, 1536]
stencil=8000, total_loss=0.00029620198625142813, total_rmsqb=0.7945761606280722
stencil=8001, total_loss=0.00029613165651842284, total_rmsqb=0.7944818235719919
stencil=8002, total_loss=0.00029600944487388954, total_rmsqb=0.794317867865543
stencil=8003, total_loss=0.00029696612502447923, total_rmsqb=0.795600420076912
stencil=8004, total_loss=0.0002957449088142282, total_rmsqb=0.7939628577645046
stencil=8005, total_loss=0.0002946901364750957, total_rmsqb=0.7925457613745477
stencil=8006, total_loss=0.00029480026262390885, total_rmsqb=0.7926938353156328
stencil=8007, total_loss=0.00028854465974261255, total_rmsqb=0.7842383361113731
stencil=8008, total_loss=0.0002908456513650681, total_rmsqb=0.7873590706632616
stencil=8009, total_loss=0.0002994609346372399, total_rmsqb=0.7989353463638919
stencil=8010, total_loss=0.0002903140820929251, total_rmsqb=0.786639226138758
stencil=8011, total_loss=0.0003119979100128089, total_rmsqb=0.8154876533446059
stencil=8012, total_loss=0.0002979352014048599, total_rmsqb=0.7968974865502326
stencil=8013, total_loss=0.0001958911767037385, total_rmsqb=0.6461732647314035
stencil=8014, total_loss=0.0001994713995323682, total_rmsqb=0.6520514501365365
[16, 3, 14, 1536]
stencil=8000, total_loss=0.0003785755139157612, total_rmsqb=0.9455711273165752
stencil=8001, total_loss=0.00037727221524328197, total_rmsqb=0.9439420942397284
stencil=8002, total_loss=0.0003784661427435506, total_rmsqb=0.9454345288186402
stencil=8003, total_loss=0.00037735915189126217, total_rmsqb=0.9440508465295044
stencil=8004, total_loss=0.00037421383686195287, total_rmsqb=0.9401082488328129
stencil=8005, total_loss=0.00037759860857042315, total_rmsqb=0.9443503270494775
stencil=8006, total_loss=0.0003737517242365266, total_rmsqb=0.939527604758264
stencil=8007, total_loss=0.0003710610635258815, total_rmsqb=0.9361396388778744
stencil=8008, total_loss=0.0003686990214402425, total_rmsqb=0.9331553168662364
stencil=8009, total_loss=0.00036930839003236523, total_rmsqb=0.9339261363544697
stencil=8010, total_loss=0.0003668394594287608, total_rmsqb=0.9307991217154421
stencil=8011, total_loss=0.00038182328604384247, total_rmsqb=0.949618458787454
stencil=8012, total_loss=0.00037686009372399544, total_rmsqb=0.9434263855145124
stencil=8013, total_loss=0.00023569721321102226, total_rmsqb=0.7460967809783575
stencil=8014, total_loss=0.00022999612464912763, total_rmsqb=0.7370181815148109
[8, 3, 14, 1536]
stencil=8000, total_loss=0.0003680407257232568, total_rmsqb=0.9813914642267757
stencil=8001, total_loss=0.00036706315989162554, total_rmsqb=0.9800872435244802
stencil=8002, total_loss=0.0003690407307001077, total_rmsqb=0.9827238311973722
stencil=8003, total_loss=0.00036694573049050823, total_rmsqb=0.9799304581575885
stencil=8004, total_loss=0.00036814603937898924, total_rmsqb=0.9815318651702579
stencil=8005, total_loss=0.0003667898053539724, total_rmsqb=0.9797222365964708
stencil=8006, total_loss=0.000367035744217574, total_rmsqb=0.9800506418478674
stencil=8007, total_loss=0.00035968826985062095, total_rmsqb=0.97019152048534
stencil=8008, total_loss=0.00038298680517635125, total_rmsqb=1.0011202428813464
stencil=8009, total_loss=0.00035060529754222467, total_rmsqb=0.9578633887540794
stencil=8010, total_loss=0.00037478611856124085, total_rmsqb=0.9903440247995204
stencil=8011, total_loss=0.0003604551036484011, total_rmsqb=0.9712251649002754
stencil=8012, total_loss=0.0003731234234631638, total_rmsqb=0.9881448098098514
stencil=8013, total_loss=0.00022944950789440552, total_rmsqb=0.7748861569029591
stencil=8014, total_loss=0.0002573536738233994, total_rmsqb=0.8206529279206962
[8, 2, 14, 1536]
stencil=8000, total_loss=0.0004045628813924762, total_rmsqb=1.0830880114999681
stencil=8001, total_loss=0.0004083169178439085, total_rmsqb=1.0881015252637378
stencil=8002, total_loss=0.0004164786394373483, total_rmsqb=1.09892258189359
stencil=8003, total_loss=0.00041335246185859767, total_rmsqb=1.094790439351036
stencil=8004, total_loss=0.00040832911951230855, total_rmsqb=1.0881177829232076
stencil=8005, total_loss=0.0004035886742891106, total_rmsqb=1.081783161174765
stencil=8006, total_loss=0.00041577119272259396, total_rmsqb=1.0979888490196963
stencil=8007, total_loss=0.00040632503589210106, total_rmsqb=1.0854442516875236
stencil=8008, total_loss=0.00040963683416400264, total_rmsqb=1.0898587928554384
stencil=8009, total_loss=0.0004310822964234645, total_rmsqb=1.1180232258908362
stencil=8010, total_loss=0.0004308124581143054, total_rmsqb=1.1176732547547221
stencil=8011, total_loss=0.00037872229887007724, total_rmsqb=1.0479273379896696
stencil=8012, total_loss=0.0004159650722156936, total_rmsqb=1.0982448223941155
stencil=8013, total_loss=0.00015638422557783178, total_rmsqb=0.673390838872054
stencil=8014, total_loss=0.0002871341364447735, total_rmsqb=0.9124585511658472
[8, 1, 14, 1536]
stencil=4013, total_loss=0.00039672214478620615, total_rmsqb=1.128990657610554
stencil=4073, total_loss=0.0005939912255469936, total_rmsqb=1.3814562683696947
stencil=4074, total_loss=0.000648841573659215, total_rmsqb=1.4438313286560807
stencil=4095, total_loss=0.000630453841745628, total_rmsqb=1.4232256896840494
stencil=4096, total_loss=0.0006366879840582223, total_rmsqb=1.430245050090455
stencil=4101, total_loss=0.0006274920357044685, total_rmsqb=1.419878671543633
stencil=4102, total_loss=0.0006316637348412765, total_rmsqb=1.4245906790549716
[4, 1, 14, 1536]
stencil=4013, total_loss=0.0003448536937303743, total_rmsqb=1.1080030664061165
stencil=4073, total_loss=0.0005737118500488732, total_rmsqb=1.4291257073058083
stencil=4074, total_loss=0.0006366691634668942, total_rmsqb=1.5054988534802423
stencil=4095, total_loss=0.0005978124161386957, total_rmsqb=1.4588343698636757
stencil=4096, total_loss=0.0006030849163580493, total_rmsqb=1.4652534564857689
stencil=4101, total_loss=0.0005921197161922938, total_rmsqb=1.451871841726803
stencil=4102, total_loss=0.0005984818192358353, total_rmsqb=1.4596509094657641
[2, 1, 14, 1536]
stencil=4013, total_loss=0.00030701386711544604, total_rmsqb=1.1004717845653882
stencil=4073, total_loss=0.0005535292864277862, total_rmsqb=1.4776453717270739
stencil=4074, total_loss=0.0002894403687713553, total_rmsqb=1.0685121562240933
stencil=4095, total_loss=0.000536489032006752, total_rmsqb=1.4547231154893532
stencil=4096, total_loss=0.0002910306703103919, total_rmsqb=1.0714435524642094
stencil=4101, total_loss=0.000528580824733489, total_rmsqb=1.4439615139458297
stencil=4102, total_loss=0.0002926634246707201, total_rmsqb=1.074444881054545
[2, 1, 14, 1536]
stencil=2014, total_loss=0.0005603304739055909, total_rmsqb=1.5649426687930776
stencil=2095, total_loss=0.0005244829190697007, total_rmsqb=1.514056162443866
stencil=2096, total_loss=0.0005317754271255685, total_rmsqb=1.524545685486079
[2, 1, 14, 768]
stencil=2014, total_loss=0.0005366255811079004, total_rmsqb=1.6120866862800363
stencil=2095, total_loss=0.000495266499956684, total_rmsqb=1.548717415088615
stencil=2096, total_loss=0.0005124885870798215, total_rmsqb=1.5754143772707725
[2, 1, 14, 384]
stencil=2014, total_loss=0.0005180074879332961, total_rmsqb=1.66723615220775
stencil=2095, total_loss=0.000499320428668361, total_rmsqb=1.6368872557851315
stencil=2096, total_loss=0.0004811150368468569, total_rmsqb=1.6067694487391755
[2, 1, 14, 384]
stencil=1004, total_loss=0.0004230049519244643, total_rmsqb=1.5859088423809515
[1, 1, 7, 192]
stencil=2090, total_loss=0.0002800100990085423, total_rmsqb=1.3582156712680704
stencil=2103, total_loss=0.00031323831892243113, total_rmsqb=1.436545320590928
stencil=2104, total_loss=0.0003302968285554624, total_rmsqb=1.4751428934443656
[1, 1, 4, 192]
stencil=2090, total_loss=0.00020542602484150752, total_rmsqb=1.2245767663260438
stencil=2103, total_loss=0.000332809091734395, total_rmsqb=1.5586760964410524
stencil=2104, total_loss=0.0002717154363522231, total_rmsqb=1.4083657018875235
[1, 1, 2, 192]
stencil=2090, total_loss=0.0002913250407176231, total_rmsqb=1.535053749793881
stencil=2103, total_loss=0.0002808031542190989, total_rmsqb=1.5070777908645228
stencil=2104, total_loss=0.0002131484862384868, total_rmsqb=1.313033496117538
[1, 1, 2, 192]
stencil=1012, total_loss=0.00011780364622403248, total_rmsqb=1.0275203695332369
[1, 1, 1, 96]
stencil=1014, total_loss=0.0001687727562665418, total_rmsqb=1.294609053708719
[1, 1, 1, 48]
stencil=1014, total_loss=0.00012407777903717944, total_rmsqb=1.168451979450737
[1, 1, 1, 24]
stencil=1014, total_loss=4.708287254591899e-06, total_rmsqb=0.23959168041706896
[1, 1, 1, 12]
stencil=1014, total_loss=4.127833437031278e-05, total_rmsqb=0.7467543047949765
[1, 1, 1, 6]
stencil=1014, total_loss=2.333196107429103e-08, total_rmsqb=0.018688251447065863
[1, 1, 1, 3]
stencil=1014, total_loss=2.506969394744374e-06, total_rmsqb=0.20391255107777645
[1, 1, 1, 2]
stencil=1014, total_loss=1.4679665127914632e-06, total_rmsqb=0.16424944506986652
[1, 1, 1, 1]
python3 -u /u/zjian1/ASTZ/py_code/compress.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -z '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_6.0e-03.astz' -c '/u/zjian1/ASTZ/stencil_list/6.0e-03/16_11_27_1536_0035.bin.txt' -E REL 6.0e-03 -4 16 11 27 1536 -M FHDE_gpu 9 -a 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
torch.Size([1, 1, 1, 1, 1, 96])
torch.Size([1, 1, 1, 1, 2, 192])
torch.Size([1, 1, 1, 1, 2, 192])
torch.Size([1, 1, 1, 1, 4, 192])
torch.Size([1, 1, 1, 1, 7, 192])
torch.Size([1, 1, 2, 1, 14, 384])
torch.Size([1, 1, 2, 1, 14, 384])
torch.Size([1, 1, 2, 1, 14, 768])
torch.Size([1, 1, 2, 1, 14, 1536])
torch.Size([1, 1, 2, 1, 14, 1536])
torch.Size([1, 1, 4, 1, 14, 1536])
torch.Size([1, 1, 8, 1, 14, 1536])
torch.Size([1, 1, 8, 2, 14, 1536])
torch.Size([1, 1, 8, 3, 14, 1536])
torch.Size([1, 1, 16, 3, 14, 1536])
torch.Size([1, 1, 16, 6, 14, 1536])
torch.Size([1, 1, 16, 11, 14, 1536])
torch.Size([1, 1, 16, 11, 27, 1536])
Huffman CR= 20.444
Zstd CR= 1.123
[31mTotal CR= 22.965 [0m
qb_min= -33, qb_max= 63
max_err= 0.7289981842041016
max_rel_err= 0.006
[31mpsnr= 50.043 [0m
====================================== BEGIN TUNING ================================
Tuning time = 2.5558e-05s
====================================== END TUNING ======================================
prediction time = 0.133088s
compression ratio = 18.14 
compression time = 0.181514
compressed data file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_6.0e-03.qoz2
Min=-30.5, Max=91, range=121.5
Max absolute error = 0.73
Max relative error = 0.006
Max pw relative error = 3.4E+06
PSNR = 49.297138, NRMSE= 0.003428807638
normError = 1125.520016, normErr_norm = 0.353336
acEff=0.935498
compression ratio = 18.140109
decompression time = 0.116893 seconds.
decompressed file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_6.0e-03.qoz2.bin
type=float nx=27 ny=11 nz=16 nw=1 raw=19008 zfp=6040 ratio=3.15 rate=10.17 rmse=0.02188 nrmse=0.0002472 maxe=0.1061 psnr=66.12
cuSZp finished!
cuSZp compression   end-to-end speed: 62.182320 GB/s
cuSZp decompression end-to-end speed: 72.746191 GB/s
cuSZp compression ratio: 10.679417

[0;32mPass error check![0m
command= python3 -u /u/zjian1/ASTZ/py_code/generate_stencil_list.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -c '/u/zjian1/ASTZ/stencil_list/3.0e-03/16_11_27_1536_0035.bin.txt' -E REL 3.0e-03 -4 16 11 27 1536 -M FHDE 9 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
stencil=8000, total_loss=0.0001698341378113518, total_rmsqb=1.0860035611364514
stencil=8001, total_loss=0.00016984748934632351, total_rmsqb=1.0860462484599416
stencil=8002, total_loss=0.00017004213874704328, total_rmsqb=1.0866683881218575
stencil=8003, total_loss=0.00016964503265669295, total_rmsqb=1.0853987767453803
stencil=8004, total_loss=0.0001877763019535393, total_rmsqb=1.1419291120291042
stencil=8005, total_loss=0.00018639039114739974, total_rmsqb=1.1377072190600652
stencil=8006, total_loss=0.0001868841346948689, total_rmsqb=1.1392131016348914
stencil=8007, total_loss=0.00018197273930271591, total_rmsqb=1.1241439313945
stencil=8008, total_loss=0.0001703370446930329, total_rmsqb=1.0876102903621394
stencil=8009, total_loss=0.00016813512762511694, total_rmsqb=1.0805577508639697
stencil=8010, total_loss=0.00017106025119344328, total_rmsqb=1.089916699140617
stencil=8011, total_loss=0.00014788170359915774, total_rmsqb=1.0133885113786079
stencil=8012, total_loss=0.00018608858442462854, total_rmsqb=1.1367857477476317
stencil=8013, total_loss=0.00014912256461581988, total_rmsqb=1.017631252167325
stencil=8014, total_loss=0.00016498923919211857, total_rmsqb=1.0704011423297453
[16, 11, 14, 1536]
stencil=8000, total_loss=0.0001927720954015874, total_rmsqb=1.2179157105756542
stencil=8001, total_loss=0.00019183250498078168, total_rmsqb=1.2149439636782773
stencil=8002, total_loss=0.00019198015833951635, total_rmsqb=1.2154114445439628
stencil=8003, total_loss=0.00019088632485315076, total_rmsqb=1.2119440110975936
stencil=8004, total_loss=0.000191923255036397, total_rmsqb=1.2152313060024054
stencil=8005, total_loss=0.0001907137783532449, total_rmsqb=1.2113961353525264
stencil=8006, total_loss=0.00019094985130665198, total_rmsqb=1.2121456601691913
stencil=8007, total_loss=0.00018667444233715126, total_rmsqb=1.1984987349752982
stencil=8008, total_loss=0.0001923154721476186, total_rmsqb=1.216472404290482
stencil=8009, total_loss=0.0001878099893872597, total_rmsqb=1.202138462723191
stencil=8010, total_loss=0.00019051862685599933, total_rmsqb=1.210776184661892
stencil=8011, total_loss=0.00020549320698938758, total_rmsqb=1.2574591448614127
stencil=8012, total_loss=0.00019044602208084137, total_rmsqb=1.2105454552289432
stencil=8013, total_loss=0.00015577694509585715, total_rmsqb=1.094830128081807
stencil=8014, total_loss=0.00016863943384497654, total_rmsqb=1.1391337426453687
[16, 6, 14, 1536]
stencil=8000, total_loss=0.0001988582686529556, total_rmsqb=1.3020970960739167
stencil=8001, total_loss=0.0001974897952488315, total_rmsqb=1.2976090719401687
stencil=8002, total_loss=0.00019836430963824305, total_rmsqb=1.3004789020902197
stencil=8003, total_loss=0.00019742005167413358, total_rmsqb=1.297379926210005
stencil=8004, total_loss=0.0001982022864798223, total_rmsqb=1.299947680663748
stencil=8005, total_loss=0.00019775472742653903, total_rmsqb=1.298479150263873
stencil=8006, total_loss=0.00019778612915340903, total_rmsqb=1.2985822397566598
stencil=8007, total_loss=0.00019325962498271092, total_rmsqb=1.2836366534361667
stencil=8008, total_loss=0.00019730441498414387, total_rmsqb=1.296999907325563
stencil=8009, total_loss=0.00019754562570190856, total_rmsqb=1.297792476310251
stencil=8010, total_loss=0.00019659361394235172, total_rmsqb=1.2946615392447622
stencil=8011, total_loss=0.00020485498108150995, total_rmsqb=1.3215841077583514
stencil=8012, total_loss=0.00019918328600314667, total_rmsqb=1.3031607465041235
stencil=8013, total_loss=0.00015599223556941546, total_rmsqb=1.1532488612137934
stencil=8014, total_loss=0.00017106172201349323, total_rmsqb=1.2076691244572197
[16, 3, 14, 1536]
stencil=8000, total_loss=0.0002258576125608679, total_rmsqb=1.460714379787087
stencil=8001, total_loss=0.0002250797765325305, total_rmsqb=1.4581969171480937
stencil=8002, total_loss=0.00022670313786646559, total_rmsqb=1.46344600615901
stencil=8003, total_loss=0.00022499458760491035, total_rmsqb=1.4579209394708044
stencil=8004, total_loss=0.00022630629255171447, total_rmsqb=1.4621645592503427
stencil=8005, total_loss=0.00022505008031821415, total_rmsqb=1.4581007193527242
stencil=8006, total_loss=0.0002262497941965144, total_rmsqb=1.4619820299703967
stencil=8007, total_loss=0.00022183215364125498, total_rmsqb=1.4476387039611063
stencil=8008, total_loss=0.00022449607293962992, total_rmsqb=1.4563049050392893
stencil=8009, total_loss=0.00022792142459724638, total_rmsqb=1.4673729654221366
stencil=8010, total_loss=0.00022342334156116327, total_rmsqb=1.4528213370384355
stencil=8011, total_loss=0.0002293539297996668, total_rmsqb=1.4719770233938247
stencil=8012, total_loss=0.00022587760824299311, total_rmsqb=1.460779038519749
stencil=8013, total_loss=0.00015888797408687385, total_rmsqb=1.2251618130728426
stencil=8014, total_loss=0.00018790959636102677, total_rmsqb=1.3323625526442207
[16, 2, 14, 1536]
stencil=8000, total_loss=0.0002404390477092486, total_rmsqb=1.5864516196176617
stencil=8001, total_loss=0.00023818979911641416, total_rmsqb=1.579013750081448
stencil=8002, total_loss=0.0002417199167099277, total_rmsqb=1.5906716862698471
stencil=8003, total_loss=0.0002403422747575867, total_rmsqb=1.5861323265195049
stencil=8004, total_loss=0.00024128221297999583, total_rmsqb=1.5892308484345046
stencil=8005, total_loss=0.00023905770651681606, total_rmsqb=1.581887910951215
stencil=8006, total_loss=0.00024185209315037096, total_rmsqb=1.591106529600451
stencil=8007, total_loss=0.00023844796824484395, total_rmsqb=1.5798692489385766
stencil=8008, total_loss=0.0002467518557300766, total_rmsqb=1.6071430944445488
stencil=8009, total_loss=0.0002477785437954897, total_rmsqb=1.610483133813536
stencil=8010, total_loss=0.00023812175422924147, total_rmsqb=1.5787881915405957
stencil=8011, total_loss=0.00023897899705906922, total_rmsqb=1.581627472181341
stencil=8012, total_loss=0.000244272655517058, total_rmsqb=1.5990489540428738
stencil=8013, total_loss=0.00012883193168678828, total_rmsqb=1.1612777153035252
stencil=8014, total_loss=0.00019031633254590197, total_rmsqb=1.4114398106713781
[16, 1, 14, 1536]
stencil=4013, total_loss=0.00022895422933888452, total_rmsqb=1.6295776617048212
stencil=4073, total_loss=0.00032968316025067503, total_rmsqb=1.9554607795847045
stencil=4074, total_loss=0.0003337651954239918, total_rmsqb=1.96752949276958
stencil=4095, total_loss=0.0003327190991888216, total_rmsqb=1.9644437299454467
stencil=4096, total_loss=0.00033785797108757163, total_rmsqb=1.9795560923631048
stencil=4101, total_loss=0.0003270285847862052, total_rmsqb=1.9475722819265666
stencil=4102, total_loss=0.00033159990948542867, total_rmsqb=1.961136980799775
[8, 1, 14, 1536]
stencil=4013, total_loss=0.0002631506580354396, total_rmsqb=1.8389899353980843
stencil=4073, total_loss=0.00030680124527188363, total_rmsqb=1.9856636300952217
stencil=4074, total_loss=0.00030766059331064743, total_rmsqb=1.9884426001225397
stencil=4095, total_loss=0.0003083130217373806, total_rmsqb=1.9905498401426154
stencil=4096, total_loss=0.0003125877012457911, total_rmsqb=2.004301564987743
stencil=4101, total_loss=0.0003016276945551992, total_rmsqb=1.9688504513940486
stencil=4102, total_loss=0.00030507852866430913, total_rmsqb=1.9800809422324885
[4, 1, 14, 1536]
stencil=4013, total_loss=0.0002152190665338117, total_rmsqb=1.7506280734726045
stencil=4073, total_loss=0.0002802836438429986, total_rmsqb=1.9978017738074296
stencil=4074, total_loss=0.00029434019699948197, total_rmsqb=2.0472850026866474
stencil=4095, total_loss=0.00028031262514319053, total_rmsqb=1.9979050573874655
stencil=4096, total_loss=0.0002819273209259313, total_rmsqb=2.003651099819649
stencil=4101, total_loss=0.0002730000841490595, total_rmsqb=1.9716730822324533
stencil=4102, total_loss=0.00027481580563286893, total_rmsqb=1.9782190073843988
[2, 1, 14, 1536]
stencil=4013, total_loss=0.00018955278747600455, total_rmsqb=1.7293981868516421
stencil=4073, total_loss=0.0002594866104527149, total_rmsqb=2.0234262890288837
stencil=4074, total_loss=0.00017668458687524407, total_rmsqb=1.669664618894237
stencil=4095, total_loss=0.00024897291080919854, total_rmsqb=1.9820105417159344
stencil=4096, total_loss=0.0001805827306803685, total_rmsqb=1.6879828101396899
stencil=4101, total_loss=0.00023855230802413536, total_rmsqb=1.9400893115187494
stencil=4102, total_loss=0.00017957169566601381, total_rmsqb=1.683250892688617
[2, 1, 14, 1536]
stencil=2014, total_loss=0.00023737716199101656, total_rmsqb=2.037162968469416
stencil=2095, total_loss=0.00022603914658190133, total_rmsqb=1.9879164880287468
stencil=2096, total_loss=0.00022533192827016205, total_rmsqb=1.9848042122234133
[2, 1, 14, 1536]
stencil=1004, total_loss=0.00017948975227157843, total_rmsqb=1.8646723463019983
[1, 1, 7, 768]
stencil=2090, total_loss=0.00013363360075478324, total_rmsqb=1.6936237337768265
stencil=2103, total_loss=0.00015738060752115192, total_rmsqb=1.8379542825249044
stencil=2104, total_loss=0.00014227910724337012, total_rmsqb=1.7475502056212124
[1, 1, 4, 768]
stencil=2090, total_loss=0.00010998983228215452, total_rmsqb=1.6173788527040907
stencil=2103, total_loss=0.00013339418423033192, total_rmsqb=1.7811641206267284
stencil=2104, total_loss=0.00010897514111957377, total_rmsqb=1.6099011497013258
[1, 1, 4, 768]
stencil=1012, total_loss=6.82682573112158e-05, total_rmsqb=1.3412856973460634
[1, 1, 2, 384]
stencil=2090, total_loss=0.00011576223350617222, total_rmsqb=1.8385342664449371
stencil=2103, total_loss=7.248417699576722e-05, total_rmsqb=1.454822087465559
stencil=2104, total_loss=5.022859048717636e-05, total_rmsqb=1.21105474469016
[1, 1, 2, 384]
stencil=1012, total_loss=3.222435287806339e-05, total_rmsqb=1.0210729637497327
[1, 1, 1, 192]
stencil=1014, total_loss=8.113213273029725e-06, total_rmsqb=0.5393088108814877
[1, 1, 1, 96]
stencil=1014, total_loss=2.3122190743012856e-05, total_rmsqb=0.9583672268640231
[1, 1, 1, 48]
stencil=1014, total_loss=4.636637464911121e-06, total_rmsqb=0.45174715774173324
[1, 1, 1, 24]
stencil=1014, total_loss=1.195275024201692e-06, total_rmsqb=0.24143719445399525
[1, 1, 1, 12]
stencil=1014, total_loss=3.9823389110656884e-05, total_rmsqb=1.4669515042634187
[1, 1, 1, 6]
stencil=1014, total_loss=6.185847269080113e-07, total_rmsqb=0.19245209332847577
[1, 1, 1, 3]
stencil=1014, total_loss=6.134337837693238e-08, total_rmsqb=0.06379450658351436
[1, 1, 1, 2]
stencil=1014, total_loss=7.121807925614121e-07, total_rmsqb=0.22880787126016175
[1, 1, 1, 1]
python3 -u /u/zjian1/ASTZ/py_code/compress.py -f32 -i '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin' -z '/work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_3.0e-03.astz' -c '/u/zjian1/ASTZ/stencil_list/3.0e-03/16_11_27_1536_0035.bin.txt' -E REL 3.0e-03 -4 16 11 27 1536 -M FHDE_gpu 9 -a 
Available threads: 16
Set threads to: 8
data_min:-30.5, data_max:91.0
torch.Size([1, 1, 1, 1, 1, 96])
torch.Size([1, 1, 1, 1, 1, 192])
torch.Size([1, 1, 1, 1, 2, 384])
torch.Size([1, 1, 1, 1, 2, 384])
torch.Size([1, 1, 1, 1, 4, 768])
torch.Size([1, 1, 1, 1, 4, 768])
torch.Size([1, 1, 1, 1, 7, 768])
torch.Size([1, 1, 2, 1, 14, 1536])
torch.Size([1, 1, 2, 1, 14, 1536])
torch.Size([1, 1, 2, 1, 14, 1536])
torch.Size([1, 1, 4, 1, 14, 1536])
torch.Size([1, 1, 8, 1, 14, 1536])
torch.Size([1, 1, 16, 1, 14, 1536])
torch.Size([1, 1, 16, 2, 14, 1536])
torch.Size([1, 1, 16, 3, 14, 1536])
torch.Size([1, 1, 16, 6, 14, 1536])
torch.Size([1, 1, 16, 11, 14, 1536])
torch.Size([1, 1, 16, 11, 27, 1536])
Huffman CR= 13.474
Zstd CR= 1.022
[31mTotal CR= 13.764 [0m
qb_min= -78, qb_max= 127
max_err= 0.3645000457763672
max_rel_err= 0.003
[31mpsnr= 55.702 [0m
====================================== BEGIN TUNING ================================
Tuning time = 2.7812e-05s
====================================== END TUNING ======================================
prediction time = 0.134253s
compression ratio = 11.98 
compression time = 0.184342
compressed data file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_3.0e-03.qoz2
Min=-30.5, Max=91, range=121.5
Max absolute error = 0.36
Max relative error = 0.003
Max pw relative error = 2.7E+06
PSNR = 55.244952, NRMSE= 0.001728830483
normError = 567.495619, normErr_norm = 0.186619
acEff=0.982432
compression ratio = 11.979453
decompression time = 0.113911 seconds.
decompressed file = /work/hdd/bdgi/zjian1/Qwen2-VL-2B-Instruct-embeddings/16_11_27_1536_0035.bin_3.0e-03.qoz2.bin
type=float nx=27 ny=11 nz=16 nw=1 raw=19008 zfp=6712 ratio=2.83 rate=11.3 rmse=0.01106 nrmse=0.0001249 maxe=0.04938 psnr=72.05
cuSZp finished!
cuSZp compression   end-to-end speed: 61.448955 GB/s
cuSZp decompression end-to-end speed: 65.838165 GB/s
cuSZp compression ratio: 8.355547

[0;32mPass error check![0m
